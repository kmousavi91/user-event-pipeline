[0m19:26:34.363816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0143d2e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafebb02740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafebb026e0>]}


============================== 19:26:34.368397 | aeb3ac96-d069-40c0-8108-fd0a943b4de1 ==============================
[0m19:26:34.368397 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:26:34.369252 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kourosh/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kourosh/dbt_user_events/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:26:34.380652 [info ] [MainThread]: dbt version: 1.9.3
[0m19:26:34.382014 [info ] [MainThread]: python version: 3.10.10
[0m19:26:34.383381 [info ] [MainThread]: python path: /home/kourosh/mambaforge/bin/python3.10
[0m19:26:34.384578 [info ] [MainThread]: os info: Linux-5.15.0-136-generic-x86_64-with-glibc2.31
[0m19:26:34.391230 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.bigquery'
[0m19:26:34.392252 [info ] [MainThread]: Using profiles dir at /home/kourosh/.dbt
[0m19:26:34.392897 [info ] [MainThread]: Using profiles.yml file at /home/kourosh/.dbt/profiles.yml
[0m19:26:34.393464 [info ] [MainThread]: Using dbt_project.yml file at /home/kourosh/dbt_user_events/dbt_project.yml
[0m19:26:34.522039 [info ] [MainThread]: Configuration:
[0m19:26:34.522849 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m19:26:34.523535 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:26:34.524239 [info ] [MainThread]: Required dependencies:
[0m19:26:34.525039 [debug] [MainThread]: Executing "git --help"
[0m19:26:34.529788 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:26:34.530540 [debug] [MainThread]: STDERR: "b''"
[0m19:26:34.531500 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:26:34.532321 [info ] [MainThread]: Connection test skipped since no profile was found
[0m19:26:34.533274 [info ] [MainThread]: [31m1 check failed:[0m
[0m19:26:34.534013 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "dbt_user_events", target "dev" invalid: Runtime Error
    Could not find adapter type bigquery!


[0m19:26:34.535573 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.23495707, "process_in_blocks": "40", "process_kernel_time": 0.362511, "process_mem_max_rss": "126588", "process_out_blocks": "16", "process_user_time": 2.119298}
[0m19:26:34.537276 [debug] [MainThread]: Command `dbt debug` failed at 19:26:34.536776 after 0.24 seconds
[0m19:26:34.538591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0143d2e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb01431a2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb014324dc0>]}
[0m19:26:34.539732 [debug] [MainThread]: Flushing usage events
[0m19:26:35.262581 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:28:06.452358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f674175f4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6718a2ed70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6718a2edd0>]}


============================== 19:28:06.455443 | f1e3ca54-4994-4722-be3e-856a661ff435 ==============================
[0m19:28:06.455443 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:28:06.456510 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kourosh/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/kourosh/dbt_user_events/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:28:06.466163 [info ] [MainThread]: dbt version: 1.9.3
[0m19:28:06.466980 [info ] [MainThread]: python version: 3.10.10
[0m19:28:06.467657 [info ] [MainThread]: python path: /home/kourosh/mambaforge/bin/python3.10
[0m19:28:06.468490 [info ] [MainThread]: os info: Linux-5.15.0-136-generic-x86_64-with-glibc2.31
[0m19:28:07.687472 [info ] [MainThread]: Using profiles dir at /home/kourosh/.dbt
[0m19:28:07.688248 [info ] [MainThread]: Using profiles.yml file at /home/kourosh/.dbt/profiles.yml
[0m19:28:07.689086 [info ] [MainThread]: Using dbt_project.yml file at /home/kourosh/dbt_user_events/dbt_project.yml
[0m19:28:07.690018 [info ] [MainThread]: adapter type: bigquery
[0m19:28:07.690816 [info ] [MainThread]: adapter version: 1.9.1
[0m19:28:07.819191 [info ] [MainThread]: Configuration:
[0m19:28:07.819975 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:28:07.820626 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:28:07.821305 [info ] [MainThread]: Required dependencies:
[0m19:28:07.822291 [debug] [MainThread]: Executing "git --help"
[0m19:28:07.825234 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:28:07.826417 [debug] [MainThread]: STDERR: "b''"
[0m19:28:07.827401 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:28:07.828399 [info ] [MainThread]: Connection:
[0m19:28:07.829456 [info ] [MainThread]:   method: oauth
[0m19:28:07.830483 [info ] [MainThread]:   database: user-event-pipeline
[0m19:28:07.831539 [info ] [MainThread]:   execution_project: user-event-pipeline
[0m19:28:07.832636 [info ] [MainThread]:   schema: bq_user_events
[0m19:28:07.833700 [info ] [MainThread]:   location: EU
[0m19:28:07.834757 [info ] [MainThread]:   priority: None
[0m19:28:07.835805 [info ] [MainThread]:   maximum_bytes_billed: None
[0m19:28:07.837064 [info ] [MainThread]:   impersonate_service_account: None
[0m19:28:07.838578 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m19:28:07.839991 [info ] [MainThread]:   job_retries: 1
[0m19:28:07.841217 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m19:28:07.842360 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m19:28:07.843508 [info ] [MainThread]:   timeout_seconds: None
[0m19:28:07.844611 [info ] [MainThread]:   client_id: None
[0m19:28:07.846111 [info ] [MainThread]:   token_uri: None
[0m19:28:07.847660 [info ] [MainThread]:   dataproc_region: None
[0m19:28:07.848799 [info ] [MainThread]:   dataproc_cluster_name: None
[0m19:28:07.849886 [info ] [MainThread]:   gcs_bucket: None
[0m19:28:07.850957 [info ] [MainThread]:   dataproc_batch: None
[0m19:28:07.852305 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:28:08.075756 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m19:28:08.076414 [debug] [MainThread]: On debug: select 1 as id
[0m19:28:08.076998 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:28:11.858400 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=user-event-pipeline&j=bq:EU:eed9d602-5b2d-40af-9036-f4744af889ba&page=queryresults
[0m19:28:12.477825 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:28:12.479530 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:28:12.481572 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 6.102226, "process_in_blocks": "3032", "process_kernel_time": 0.525608, "process_mem_max_rss": "251592", "process_out_blocks": "24", "process_user_time": 3.575733}
[0m19:28:12.483209 [debug] [MainThread]: Command `dbt debug` succeeded at 19:28:12.482968 after 6.10 seconds
[0m19:28:12.484213 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:28:12.485683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f674175f4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6718a2ee30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6709c22aa0>]}
[0m19:28:12.487668 [debug] [MainThread]: Flushing usage events
[0m19:28:13.290004 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:33:06.487387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b2de6b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b0540a290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b0540a230>]}


============================== 19:33:06.490514 | 95ac6ef5-37a6-4e64-b4aa-0983b7d02359 ==============================
[0m19:33:06.490514 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:33:06.491404 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kourosh/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/kourosh/dbt_user_events/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:33:07.896971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95ac6ef5-37a6-4e64-b4aa-0983b7d02359', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b2ddbc910>]}
[0m19:33:07.962968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95ac6ef5-37a6-4e64-b4aa-0983b7d02359', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b2dc8f520>]}
[0m19:33:07.963952 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:33:08.180392 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:33:08.181354 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:33:08.182061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '95ac6ef5-37a6-4e64-b4aa-0983b7d02359', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8af6582080>]}
[0m19:33:10.001208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95ac6ef5-37a6-4e64-b4aa-0983b7d02359', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8af62a0f10>]}
[0m19:33:10.133591 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kourosh/dbt_user_events/target/manifest.json
[0m19:33:10.135626 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kourosh/dbt_user_events/target/semantic_manifest.json
[0m19:33:10.151645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95ac6ef5-37a6-4e64-b4aa-0983b7d02359', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8af6217550>]}
[0m19:33:10.152463 [info ] [MainThread]: Found 4 models, 6 data tests, 1 source, 491 macros
[0m19:33:10.153134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95ac6ef5-37a6-4e64-b4aa-0983b7d02359', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8af6216590>]}
[0m19:33:10.154675 [info ] [MainThread]: 
[0m19:33:10.155542 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:33:10.156750 [info ] [MainThread]: 
[0m19:33:10.157557 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:33:10.164616 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_user-event-pipeline'
[0m19:33:10.165559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:33:11.221292 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user-event-pipeline, now list_user-event-pipeline_bq_user_events)
[0m19:33:11.225207 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:33:11.690280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95ac6ef5-37a6-4e64-b4aa-0983b7d02359', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b2fa7b8e0>]}
[0m19:33:11.693528 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:33:11.705961 [debug] [Thread-1 (]: Began running node model.dbt_user_events.my_first_dbt_model
[0m19:33:11.709460 [info ] [Thread-1 (]: 1 of 4 START sql table model bq_user_events.my_first_dbt_model ................. [RUN]
[0m19:33:11.712513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user-event-pipeline_bq_user_events, now model.dbt_user_events.my_first_dbt_model)
[0m19:33:11.715289 [debug] [Thread-1 (]: Began compiling node model.dbt_user_events.my_first_dbt_model
[0m19:33:11.746467 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_user_events.my_first_dbt_model"
[0m19:33:11.747663 [debug] [Thread-1 (]: Began executing node model.dbt_user_events.my_first_dbt_model
[0m19:33:11.798329 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_user_events.my_first_dbt_model"
[0m19:33:11.799404 [debug] [Thread-1 (]: On model.dbt_user_events.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_user_events", "target_name": "dev", "node_id": "model.dbt_user_events.my_first_dbt_model"} */

  
    

    create or replace table `user-event-pipeline`.`bq_user_events`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m19:33:11.800136 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:33:12.372577 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=user-event-pipeline&j=bq:EU:d5508f79-6778-4b3f-961c-a9d8d25cf31c&page=queryresults
[0m19:33:15.117299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95ac6ef5-37a6-4e64-b4aa-0983b7d02359', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b2e0530a0>]}
[0m19:33:15.118392 [info ] [Thread-1 (]: 1 of 4 OK created sql table model bq_user_events.my_first_dbt_model ............ [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.40s]
[0m19:33:15.119565 [debug] [Thread-1 (]: Finished running node model.dbt_user_events.my_first_dbt_model
[0m19:33:15.120461 [debug] [Thread-1 (]: Began running node model.dbt_user_events.stg_raw_events
[0m19:33:15.121769 [info ] [Thread-1 (]: 2 of 4 START sql view model bq_user_events.stg_raw_events ...................... [RUN]
[0m19:33:15.122722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_user_events.my_first_dbt_model, now model.dbt_user_events.stg_raw_events)
[0m19:33:15.123964 [debug] [Thread-1 (]: Began compiling node model.dbt_user_events.stg_raw_events
[0m19:33:15.128639 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_user_events.stg_raw_events"
[0m19:33:15.129645 [debug] [Thread-1 (]: Began executing node model.dbt_user_events.stg_raw_events
[0m19:33:15.159935 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_user_events.stg_raw_events"
[0m19:33:15.160891 [debug] [Thread-1 (]: On model.dbt_user_events.stg_raw_events: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_user_events", "target_name": "dev", "node_id": "model.dbt_user_events.stg_raw_events"} */


  create or replace view `user-event-pipeline`.`bq_user_events`.`stg_raw_events`
  OPTIONS()
  as 

SELECT
  event_id,
  user_id,
  event_type,
  page,
  TIMESTAMP(timestamp) AS event_timestamp,
  device_type
FROM `user-event-pipeline`.`bq_user_events`.`raw_events`;


[0m19:33:15.161555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:33:15.985379 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=user-event-pipeline&j=bq:EU:4d85c816-3cca-4862-9c55-2784ce155d57&page=queryresults
[0m19:33:16.426429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95ac6ef5-37a6-4e64-b4aa-0983b7d02359', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8af63f86d0>]}
[0m19:33:16.430500 [info ] [Thread-1 (]: 2 of 4 OK created sql view model bq_user_events.stg_raw_events ................. [[32mCREATE VIEW (0 processed)[0m in 1.30s]
[0m19:33:16.434845 [debug] [Thread-1 (]: Finished running node model.dbt_user_events.stg_raw_events
[0m19:33:16.438913 [debug] [Thread-1 (]: Began running node model.dbt_user_events.my_second_dbt_model
[0m19:33:16.442622 [info ] [Thread-1 (]: 3 of 4 START sql view model bq_user_events.my_second_dbt_model ................. [RUN]
[0m19:33:16.444981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_user_events.stg_raw_events, now model.dbt_user_events.my_second_dbt_model)
[0m19:33:16.446384 [debug] [Thread-1 (]: Began compiling node model.dbt_user_events.my_second_dbt_model
[0m19:33:16.455395 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_user_events.my_second_dbt_model"
[0m19:33:16.457556 [debug] [Thread-1 (]: Began executing node model.dbt_user_events.my_second_dbt_model
[0m19:33:16.464424 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_user_events.my_second_dbt_model"
[0m19:33:16.465374 [debug] [Thread-1 (]: On model.dbt_user_events.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_user_events", "target_name": "dev", "node_id": "model.dbt_user_events.my_second_dbt_model"} */


  create or replace view `user-event-pipeline`.`bq_user_events`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `user-event-pipeline`.`bq_user_events`.`my_first_dbt_model`
where id = 1;


[0m19:33:16.466134 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:33:17.011691 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=user-event-pipeline&j=bq:EU:ecb78efb-4d83-43ae-8f6e-af3d073030dd&page=queryresults
[0m19:33:17.451432 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95ac6ef5-37a6-4e64-b4aa-0983b7d02359', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8af6216950>]}
[0m19:33:17.456276 [info ] [Thread-1 (]: 3 of 4 OK created sql view model bq_user_events.my_second_dbt_model ............ [[32mCREATE VIEW (0 processed)[0m in 1.01s]
[0m19:33:17.460424 [debug] [Thread-1 (]: Finished running node model.dbt_user_events.my_second_dbt_model
[0m19:33:17.463276 [debug] [Thread-1 (]: Began running node model.dbt_user_events.daily_events
[0m19:33:17.466556 [info ] [Thread-1 (]: 4 of 4 START sql table model bq_user_events.daily_events ....................... [RUN]
[0m19:33:17.469071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_user_events.my_second_dbt_model, now model.dbt_user_events.daily_events)
[0m19:33:17.470656 [debug] [Thread-1 (]: Began compiling node model.dbt_user_events.daily_events
[0m19:33:17.478467 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_user_events.daily_events"
[0m19:33:17.480357 [debug] [Thread-1 (]: Began executing node model.dbt_user_events.daily_events
[0m19:33:17.489056 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_user_events.daily_events"
[0m19:33:17.490477 [debug] [Thread-1 (]: On model.dbt_user_events.daily_events: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_user_events", "target_name": "dev", "node_id": "model.dbt_user_events.daily_events"} */

  
    

    create or replace table `user-event-pipeline`.`bq_user_events`.`daily_events`
      
    
    

    OPTIONS()
    as (
      

SELECT
  DATE(event_timestamp) AS event_date,
  user_id,
  device_type,
  COUNT(*) AS event_count
FROM `user-event-pipeline`.`bq_user_events`.`stg_raw_events`
GROUP BY 1, 2, 3
    );
  
[0m19:33:17.491359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:33:18.445958 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=user-event-pipeline&j=bq:EU:cd7376eb-83ed-443c-8499-52b9be6ccd1e&page=queryresults
[0m19:33:20.910802 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95ac6ef5-37a6-4e64-b4aa-0983b7d02359', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8af42e8130>]}
[0m19:33:20.915242 [info ] [Thread-1 (]: 4 of 4 OK created sql table model bq_user_events.daily_events .................. [[32mCREATE TABLE (8.0 rows, 0 processed)[0m in 3.44s]
[0m19:33:20.920611 [debug] [Thread-1 (]: Finished running node model.dbt_user_events.daily_events
[0m19:33:20.925389 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:33:20.928001 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:33:20.929321 [debug] [MainThread]: Connection 'model.dbt_user_events.daily_events' was properly closed.
[0m19:33:20.930773 [info ] [MainThread]: 
[0m19:33:20.932403 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 10.77 seconds (10.77s).
[0m19:33:20.937244 [debug] [MainThread]: Command end result
[0m19:33:20.976524 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kourosh/dbt_user_events/target/manifest.json
[0m19:33:20.978360 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kourosh/dbt_user_events/target/semantic_manifest.json
[0m19:33:20.988362 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kourosh/dbt_user_events/target/run_results.json
[0m19:33:20.989647 [info ] [MainThread]: 
[0m19:33:20.990532 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:33:20.991255 [info ] [MainThread]: 
[0m19:33:20.992221 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:33:20.993353 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.576379, "process_in_blocks": "12040", "process_kernel_time": 0.558719, "process_mem_max_rss": "264588", "process_out_blocks": "3176", "process_user_time": 6.002243}
[0m19:33:20.994241 [debug] [MainThread]: Command `dbt run` succeeded at 19:33:20.994126 after 14.58 seconds
[0m19:33:20.994969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b2de6b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b2ddbc910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8af6434d60>]}
[0m19:33:20.995599 [debug] [MainThread]: Flushing usage events
[0m19:33:22.026816 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:33:32.166425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe5b2f4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbbd229840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbbd22bbb0>]}


============================== 19:33:32.169331 | de977185-b3fa-42d7-9199-169f257cdd50 ==============================
[0m19:33:32.169331 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:33:32.170137 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kourosh/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/kourosh/dbt_user_events/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m19:33:33.512062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de977185-b3fa-42d7-9199-169f257cdd50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe76a5d50>]}
[0m19:33:33.579422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de977185-b3fa-42d7-9199-169f257cdd50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbae492650>]}
[0m19:33:33.580336 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:33:33.793498 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:33:33.952545 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:33:33.953182 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:33:34.015429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de977185-b3fa-42d7-9199-169f257cdd50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbade7c220>]}
[0m19:33:34.146739 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kourosh/dbt_user_events/target/manifest.json
[0m19:33:34.148736 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kourosh/dbt_user_events/target/semantic_manifest.json
[0m19:33:34.171689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de977185-b3fa-42d7-9199-169f257cdd50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbade7d4e0>]}
[0m19:33:34.172476 [info ] [MainThread]: Found 4 models, 6 data tests, 1 source, 491 macros
[0m19:33:34.173128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de977185-b3fa-42d7-9199-169f257cdd50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbade5e530>]}
[0m19:33:34.174731 [info ] [MainThread]: 
[0m19:33:34.175374 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:33:34.175946 [info ] [MainThread]: 
[0m19:33:34.176828 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:33:34.183085 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_user-event-pipeline_bq_user_events'
[0m19:33:34.183888 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:33:35.227238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de977185-b3fa-42d7-9199-169f257cdd50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe772baf0>]}
[0m19:33:35.231133 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:33:35.251256 [debug] [Thread-1 (]: Began running node test.dbt_user_events.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:33:35.255336 [info ] [Thread-1 (]: 1 of 6 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m19:33:35.258229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user-event-pipeline_bq_user_events, now test.dbt_user_events.not_null_my_first_dbt_model_id.5fb22c2710)
[0m19:33:35.260155 [debug] [Thread-1 (]: Began compiling node test.dbt_user_events.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:33:35.313612 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_user_events.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:33:35.314892 [debug] [Thread-1 (]: Began executing node test.dbt_user_events.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:33:35.342652 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_user_events.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:33:35.343662 [debug] [Thread-1 (]: On test.dbt_user_events.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_user_events", "target_name": "dev", "node_id": "test.dbt_user_events.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `user-event-pipeline`.`bq_user_events`.`my_first_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m19:33:35.344932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:33:36.261980 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=user-event-pipeline&j=bq:EU:1b8cfd63-dae0-4a37-a501-ef57d5ac0ffb&page=queryresults
[0m19:33:36.899061 [error] [Thread-1 (]: 1 of 6 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.64s]
[0m19:33:36.902064 [debug] [Thread-1 (]: Finished running node test.dbt_user_events.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:33:36.903914 [debug] [Thread-1 (]: Began running node test.dbt_user_events.not_null_my_second_dbt_model_id.151b76d778
[0m19:33:36.905566 [info ] [Thread-1 (]: 2 of 6 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m19:33:36.907715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_user_events.not_null_my_first_dbt_model_id.5fb22c2710, now test.dbt_user_events.not_null_my_second_dbt_model_id.151b76d778)
[0m19:33:36.909749 [debug] [Thread-1 (]: Began compiling node test.dbt_user_events.not_null_my_second_dbt_model_id.151b76d778
[0m19:33:36.922492 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_user_events.not_null_my_second_dbt_model_id.151b76d778"
[0m19:33:36.924339 [debug] [Thread-1 (]: Began executing node test.dbt_user_events.not_null_my_second_dbt_model_id.151b76d778
[0m19:33:36.929913 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_user_events.not_null_my_second_dbt_model_id.151b76d778"
[0m19:33:36.931867 [debug] [Thread-1 (]: On test.dbt_user_events.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_user_events", "target_name": "dev", "node_id": "test.dbt_user_events.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `user-event-pipeline`.`bq_user_events`.`my_second_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m19:33:36.933279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:33:37.797633 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=user-event-pipeline&j=bq:EU:b7d6f381-e950-4ce6-ae57-7c7f66bf5f6a&page=queryresults
[0m19:33:38.417277 [info ] [Thread-1 (]: 2 of 6 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.51s]
[0m19:33:38.421928 [debug] [Thread-1 (]: Finished running node test.dbt_user_events.not_null_my_second_dbt_model_id.151b76d778
[0m19:33:38.425014 [debug] [Thread-1 (]: Began running node test.dbt_user_events.not_null_stg_raw_events_event_id.348d6d9dd0
[0m19:33:38.429966 [info ] [Thread-1 (]: 3 of 6 START test not_null_stg_raw_events_event_id ............................. [RUN]
[0m19:33:38.433511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_user_events.not_null_my_second_dbt_model_id.151b76d778, now test.dbt_user_events.not_null_stg_raw_events_event_id.348d6d9dd0)
[0m19:33:38.436382 [debug] [Thread-1 (]: Began compiling node test.dbt_user_events.not_null_stg_raw_events_event_id.348d6d9dd0
[0m19:33:38.453408 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_user_events.not_null_stg_raw_events_event_id.348d6d9dd0"
[0m19:33:38.455450 [debug] [Thread-1 (]: Began executing node test.dbt_user_events.not_null_stg_raw_events_event_id.348d6d9dd0
[0m19:33:38.462935 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_user_events.not_null_stg_raw_events_event_id.348d6d9dd0"
[0m19:33:38.464572 [debug] [Thread-1 (]: On test.dbt_user_events.not_null_stg_raw_events_event_id.348d6d9dd0: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_user_events", "target_name": "dev", "node_id": "test.dbt_user_events.not_null_stg_raw_events_event_id.348d6d9dd0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from `user-event-pipeline`.`bq_user_events`.`stg_raw_events`
where event_id is null



      
    ) dbt_internal_test
[0m19:33:38.465940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:33:39.641748 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=user-event-pipeline&j=bq:EU:47cb6108-8e81-485f-8f95-7f8956564f96&page=queryresults
[0m19:33:40.260217 [info ] [Thread-1 (]: 3 of 6 PASS not_null_stg_raw_events_event_id ................................... [[32mPASS[0m in 1.82s]
[0m19:33:40.264437 [debug] [Thread-1 (]: Finished running node test.dbt_user_events.not_null_stg_raw_events_event_id.348d6d9dd0
[0m19:33:40.267217 [debug] [Thread-1 (]: Began running node test.dbt_user_events.not_null_stg_raw_events_user_id.f7e4d46214
[0m19:33:40.270029 [info ] [Thread-1 (]: 4 of 6 START test not_null_stg_raw_events_user_id .............................. [RUN]
[0m19:33:40.273025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_user_events.not_null_stg_raw_events_event_id.348d6d9dd0, now test.dbt_user_events.not_null_stg_raw_events_user_id.f7e4d46214)
[0m19:33:40.275350 [debug] [Thread-1 (]: Began compiling node test.dbt_user_events.not_null_stg_raw_events_user_id.f7e4d46214
[0m19:33:40.291462 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_user_events.not_null_stg_raw_events_user_id.f7e4d46214"
[0m19:33:40.293799 [debug] [Thread-1 (]: Began executing node test.dbt_user_events.not_null_stg_raw_events_user_id.f7e4d46214
[0m19:33:40.300884 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_user_events.not_null_stg_raw_events_user_id.f7e4d46214"
[0m19:33:40.302444 [debug] [Thread-1 (]: On test.dbt_user_events.not_null_stg_raw_events_user_id.f7e4d46214: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_user_events", "target_name": "dev", "node_id": "test.dbt_user_events.not_null_stg_raw_events_user_id.f7e4d46214"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from `user-event-pipeline`.`bq_user_events`.`stg_raw_events`
where user_id is null



      
    ) dbt_internal_test
[0m19:33:40.303865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:33:41.483789 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=user-event-pipeline&j=bq:EU:1e2227b5-e0e3-4a99-adbd-7048ef11302f&page=queryresults
[0m19:33:42.104461 [info ] [Thread-1 (]: 4 of 6 PASS not_null_stg_raw_events_user_id .................................... [[32mPASS[0m in 1.83s]
[0m19:33:42.109209 [debug] [Thread-1 (]: Finished running node test.dbt_user_events.not_null_stg_raw_events_user_id.f7e4d46214
[0m19:33:42.112371 [debug] [Thread-1 (]: Began running node test.dbt_user_events.unique_my_first_dbt_model_id.16e066b321
[0m19:33:42.117244 [info ] [Thread-1 (]: 5 of 6 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m19:33:42.122227 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_user_events.not_null_stg_raw_events_user_id.f7e4d46214, now test.dbt_user_events.unique_my_first_dbt_model_id.16e066b321)
[0m19:33:42.126787 [debug] [Thread-1 (]: Began compiling node test.dbt_user_events.unique_my_first_dbt_model_id.16e066b321
[0m19:33:42.149541 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_user_events.unique_my_first_dbt_model_id.16e066b321"
[0m19:33:42.151278 [debug] [Thread-1 (]: Began executing node test.dbt_user_events.unique_my_first_dbt_model_id.16e066b321
[0m19:33:42.155366 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_user_events.unique_my_first_dbt_model_id.16e066b321"
[0m19:33:42.156247 [debug] [Thread-1 (]: On test.dbt_user_events.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_user_events", "target_name": "dev", "node_id": "test.dbt_user_events.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `user-event-pipeline`.`bq_user_events`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:33:42.157824 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:33:42.849636 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=user-event-pipeline&j=bq:EU:4970aa1c-14a3-46b9-b6e4-2c314e426c1e&page=queryresults
[0m19:33:43.331565 [info ] [Thread-1 (]: 5 of 6 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.21s]
[0m19:33:43.335473 [debug] [Thread-1 (]: Finished running node test.dbt_user_events.unique_my_first_dbt_model_id.16e066b321
[0m19:33:43.338347 [debug] [Thread-1 (]: Began running node test.dbt_user_events.unique_my_second_dbt_model_id.57a0f8c493
[0m19:33:43.342690 [info ] [Thread-1 (]: 6 of 6 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m19:33:43.346501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_user_events.unique_my_first_dbt_model_id.16e066b321, now test.dbt_user_events.unique_my_second_dbt_model_id.57a0f8c493)
[0m19:33:43.349394 [debug] [Thread-1 (]: Began compiling node test.dbt_user_events.unique_my_second_dbt_model_id.57a0f8c493
[0m19:33:43.364129 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_user_events.unique_my_second_dbt_model_id.57a0f8c493"
[0m19:33:43.365542 [debug] [Thread-1 (]: Began executing node test.dbt_user_events.unique_my_second_dbt_model_id.57a0f8c493
[0m19:33:43.370176 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_user_events.unique_my_second_dbt_model_id.57a0f8c493"
[0m19:33:43.371254 [debug] [Thread-1 (]: On test.dbt_user_events.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_user_events", "target_name": "dev", "node_id": "test.dbt_user_events.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `user-event-pipeline`.`bq_user_events`.`my_second_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:33:43.372060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:33:44.557043 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=user-event-pipeline&j=bq:EU:8fe17375-4524-4c12-91c0-abd057080474&page=queryresults
[0m19:33:45.107992 [info ] [Thread-1 (]: 6 of 6 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 1.76s]
[0m19:33:45.109200 [debug] [Thread-1 (]: Finished running node test.dbt_user_events.unique_my_second_dbt_model_id.57a0f8c493
[0m19:33:45.110549 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:33:45.111405 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:33:45.111955 [debug] [MainThread]: Connection 'test.dbt_user_events.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m19:33:45.112526 [info ] [MainThread]: 
[0m19:33:45.113179 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 10.94 seconds (10.94s).
[0m19:33:45.115496 [debug] [MainThread]: Command end result
[0m19:33:45.153660 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kourosh/dbt_user_events/target/manifest.json
[0m19:33:45.155969 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kourosh/dbt_user_events/target/semantic_manifest.json
[0m19:33:45.166947 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kourosh/dbt_user_events/target/run_results.json
[0m19:33:45.167599 [info ] [MainThread]: 
[0m19:33:45.168413 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:33:45.169403 [info ] [MainThread]: 
[0m19:33:45.170167 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m19:33:45.170894 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m19:33:45.171509 [info ] [MainThread]: 
[0m19:33:45.173182 [info ] [MainThread]:   compiled code at target/compiled/dbt_user_events/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m19:33:45.174515 [info ] [MainThread]: 
[0m19:33:45.175568 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m19:33:45.177104 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 13.073592, "process_in_blocks": "1432", "process_kernel_time": 0.608209, "process_mem_max_rss": "260356", "process_out_blocks": "2184", "process_user_time": 4.525559}
[0m19:33:45.178044 [debug] [MainThread]: Command `dbt test` failed at 19:33:45.177919 after 13.07 seconds
[0m19:33:45.178751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe5b2f4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbae381150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbade92470>]}
[0m19:33:45.179977 [debug] [MainThread]: Flushing usage events
[0m19:33:45.924513 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:34:42.150721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f9ef17490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f9ee839d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f7660ffa0>]}


============================== 19:34:42.153786 | abd29a21-193c-4dfa-a9c5-92788d7c873c ==============================
[0m19:34:42.153786 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:34:42.155557 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/kourosh/dbt_user_events/logs', 'version_check': 'True', 'profiles_dir': '/home/kourosh/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:34:43.483528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'abd29a21-193c-4dfa-a9c5-92788d7c873c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fa0a81cf0>]}
[0m19:34:43.549332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'abd29a21-193c-4dfa-a9c5-92788d7c873c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f677004f0>]}
[0m19:34:43.550226 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:34:43.762130 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:34:43.920381 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 0 files changed.
[0m19:34:43.921223 [debug] [MainThread]: Partial parsing: deleted file: dbt_user_events://models/example/my_second_dbt_model.sql
[0m19:34:43.921827 [debug] [MainThread]: Partial parsing: deleted file: dbt_user_events://models/example/my_first_dbt_model.sql
[0m19:34:44.023769 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_user_events.example
[0m19:34:44.046899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'abd29a21-193c-4dfa-a9c5-92788d7c873c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f6725e7d0>]}
[0m19:34:44.162108 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kourosh/dbt_user_events/target/manifest.json
[0m19:34:44.164212 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kourosh/dbt_user_events/target/semantic_manifest.json
[0m19:34:44.184622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'abd29a21-193c-4dfa-a9c5-92788d7c873c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f6725d5a0>]}
[0m19:34:44.185424 [info ] [MainThread]: Found 2 models, 2 data tests, 1 source, 491 macros
[0m19:34:44.186075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abd29a21-193c-4dfa-a9c5-92788d7c873c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f67cb4160>]}
[0m19:34:44.187397 [info ] [MainThread]: 
[0m19:34:44.188072 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:34:44.189031 [info ] [MainThread]: 
[0m19:34:44.190013 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:34:44.196366 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_user-event-pipeline_bq_user_events'
[0m19:34:44.197457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:34:45.208260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abd29a21-193c-4dfa-a9c5-92788d7c873c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fa0b0f8e0>]}
[0m19:34:45.209529 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:34:45.213415 [debug] [Thread-1 (]: Began running node test.dbt_user_events.not_null_stg_raw_events_event_id.348d6d9dd0
[0m19:34:45.214992 [info ] [Thread-1 (]: 1 of 2 START test not_null_stg_raw_events_event_id ............................. [RUN]
[0m19:34:45.216225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user-event-pipeline_bq_user_events, now test.dbt_user_events.not_null_stg_raw_events_event_id.348d6d9dd0)
[0m19:34:45.216997 [debug] [Thread-1 (]: Began compiling node test.dbt_user_events.not_null_stg_raw_events_event_id.348d6d9dd0
[0m19:34:45.253160 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_user_events.not_null_stg_raw_events_event_id.348d6d9dd0"
[0m19:34:45.254533 [debug] [Thread-1 (]: Began executing node test.dbt_user_events.not_null_stg_raw_events_event_id.348d6d9dd0
[0m19:34:45.293036 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_user_events.not_null_stg_raw_events_event_id.348d6d9dd0"
[0m19:34:45.294546 [debug] [Thread-1 (]: On test.dbt_user_events.not_null_stg_raw_events_event_id.348d6d9dd0: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_user_events", "target_name": "dev", "node_id": "test.dbt_user_events.not_null_stg_raw_events_event_id.348d6d9dd0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from `user-event-pipeline`.`bq_user_events`.`stg_raw_events`
where event_id is null



      
    ) dbt_internal_test
[0m19:34:45.295789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:34:46.304955 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=user-event-pipeline&j=bq:EU:f2d5d5bd-b903-495c-b5e8-2aabd61a06c1&page=queryresults
[0m19:34:46.941030 [info ] [Thread-1 (]: 1 of 2 PASS not_null_stg_raw_events_event_id ................................... [[32mPASS[0m in 1.72s]
[0m19:34:46.945016 [debug] [Thread-1 (]: Finished running node test.dbt_user_events.not_null_stg_raw_events_event_id.348d6d9dd0
[0m19:34:46.947735 [debug] [Thread-1 (]: Began running node test.dbt_user_events.not_null_stg_raw_events_user_id.f7e4d46214
[0m19:34:46.949862 [info ] [Thread-1 (]: 2 of 2 START test not_null_stg_raw_events_user_id .............................. [RUN]
[0m19:34:46.951690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_user_events.not_null_stg_raw_events_event_id.348d6d9dd0, now test.dbt_user_events.not_null_stg_raw_events_user_id.f7e4d46214)
[0m19:34:46.952992 [debug] [Thread-1 (]: Began compiling node test.dbt_user_events.not_null_stg_raw_events_user_id.f7e4d46214
[0m19:34:46.964543 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_user_events.not_null_stg_raw_events_user_id.f7e4d46214"
[0m19:34:46.965689 [debug] [Thread-1 (]: Began executing node test.dbt_user_events.not_null_stg_raw_events_user_id.f7e4d46214
[0m19:34:46.971115 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_user_events.not_null_stg_raw_events_user_id.f7e4d46214"
[0m19:34:46.972914 [debug] [Thread-1 (]: On test.dbt_user_events.not_null_stg_raw_events_user_id.f7e4d46214: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_user_events", "target_name": "dev", "node_id": "test.dbt_user_events.not_null_stg_raw_events_user_id.f7e4d46214"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from `user-event-pipeline`.`bq_user_events`.`stg_raw_events`
where user_id is null



      
    ) dbt_internal_test
[0m19:34:46.973671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:34:47.856822 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=user-event-pipeline&j=bq:EU:2d07d226-639d-4a10-b458-bff7092f5ef1&page=queryresults
[0m19:34:48.388177 [info ] [Thread-1 (]: 2 of 2 PASS not_null_stg_raw_events_user_id .................................... [[32mPASS[0m in 1.44s]
[0m19:34:48.392574 [debug] [Thread-1 (]: Finished running node test.dbt_user_events.not_null_stg_raw_events_user_id.f7e4d46214
[0m19:34:48.398884 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:34:48.402653 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:34:48.405414 [debug] [MainThread]: Connection 'test.dbt_user_events.not_null_stg_raw_events_user_id.f7e4d46214' was properly closed.
[0m19:34:48.407562 [info ] [MainThread]: 
[0m19:34:48.409611 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 4.22 seconds (4.22s).
[0m19:34:48.414050 [debug] [MainThread]: Command end result
[0m19:34:48.462495 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kourosh/dbt_user_events/target/manifest.json
[0m19:34:48.465500 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kourosh/dbt_user_events/target/semantic_manifest.json
[0m19:34:48.474946 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kourosh/dbt_user_events/target/run_results.json
[0m19:34:48.475609 [info ] [MainThread]: 
[0m19:34:48.476344 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:34:48.477238 [info ] [MainThread]: 
[0m19:34:48.479008 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m19:34:48.480132 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.409918, "process_in_blocks": "0", "process_kernel_time": 0.436121, "process_mem_max_rss": "260832", "process_out_blocks": "3032", "process_user_time": 4.153156}
[0m19:34:48.481145 [debug] [MainThread]: Command `dbt test` succeeded at 19:34:48.480953 after 6.41 seconds
[0m19:34:48.481951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f9ef17490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fa0a81cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f6725e410>]}
[0m19:34:48.482955 [debug] [MainThread]: Flushing usage events
[0m19:34:49.383180 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:51:36.622481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f513e243580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f511567f7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f511567ef20>]}


============================== 19:51:36.625328 | 51a3bfcc-850f-47e5-9d97-e45d4f3f32bc ==============================
[0m19:51:36.625328 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:51:36.626102 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/kourosh/dbt_user_events/logs', 'version_check': 'True', 'profiles_dir': '/home/kourosh/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select vault', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:51:37.961693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51a3bfcc-850f-47e5-9d97-e45d4f3f32bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f513fbb4ee0>]}
[0m19:51:38.028254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51a3bfcc-850f-47e5-9d97-e45d4f3f32bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51068ff460>]}
[0m19:51:38.029234 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:51:38.251095 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:51:38.411475 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 1 files changed.
[0m19:51:38.412303 [debug] [MainThread]: Partial parsing: added file: dbt_user_events://models/vault/link_user_event.sql
[0m19:51:38.413247 [debug] [MainThread]: Partial parsing: added file: dbt_user_events://models/vault/hub_event.sql
[0m19:51:38.414395 [debug] [MainThread]: Partial parsing: added file: dbt_user_events://models/vault/sat_event_metadata.sql
[0m19:51:38.415494 [debug] [MainThread]: Partial parsing: added file: dbt_user_events://models/vault/hub_user.sql
[0m19:51:38.416667 [debug] [MainThread]: Partial parsing: updated file: dbt_user_events://models/staging/schema.yml
[0m19:51:38.978527 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_user_events.link_user_event' (models/vault/link_user_event.sql) depends on a source named 'bq_user_events.raw_events' which was not found
[0m19:51:38.979594 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.4213371, "process_in_blocks": "0", "process_kernel_time": 0.506282, "process_mem_max_rss": "254528", "process_out_blocks": "16", "process_user_time": 4.130622}
[0m19:51:38.980653 [debug] [MainThread]: Command `dbt run` failed at 19:51:38.980500 after 2.42 seconds
[0m19:51:38.981361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f513e243580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5105875240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5105875210>]}
[0m19:51:38.981995 [debug] [MainThread]: Flushing usage events
[0m19:51:39.767751 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:51:53.733525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69a240b580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6979b06ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6979b054b0>]}


============================== 19:51:53.739330 | c79f1355-8552-4034-aa17-eb4dd9cfdb3c ==============================
[0m19:51:53.739330 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:51:53.741255 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kourosh/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/kourosh/dbt_user_events/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select vault', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:51:55.104055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c79f1355-8552-4034-aa17-eb4dd9cfdb3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f697a025d20>]}
[0m19:51:55.174197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c79f1355-8552-4034-aa17-eb4dd9cfdb3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f696ac76a40>]}
[0m19:51:55.175141 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:51:55.390130 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:51:55.550969 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 1 files changed.
[0m19:51:55.551830 [debug] [MainThread]: Partial parsing: added file: dbt_user_events://models/vault/sat_event_metadata.sql
[0m19:51:55.552445 [debug] [MainThread]: Partial parsing: added file: dbt_user_events://models/vault/hub_user.sql
[0m19:51:55.553044 [debug] [MainThread]: Partial parsing: added file: dbt_user_events://models/vault/hub_event.sql
[0m19:51:55.553629 [debug] [MainThread]: Partial parsing: added file: dbt_user_events://models/vault/link_user_event.sql
[0m19:51:55.554437 [debug] [MainThread]: Partial parsing: updated file: dbt_user_events://models/staging/schema.yml
[0m19:51:56.102167 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_user_events.sat_event_metadata' (models/vault/sat_event_metadata.sql) depends on a source named 'bq_user_events.raw_events' which was not found
[0m19:51:56.103151 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.4373853, "process_in_blocks": "0", "process_kernel_time": 0.570465, "process_mem_max_rss": "254696", "process_out_blocks": "8", "process_user_time": 4.192722}
[0m19:51:56.103968 [debug] [MainThread]: Command `dbt test` failed at 19:51:56.103845 after 2.44 seconds
[0m19:51:56.104608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69a240b580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f696a525420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f696a524f40>]}
[0m19:51:56.105287 [debug] [MainThread]: Flushing usage events
[0m19:51:56.780504 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:38:18.191797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a98e31f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4810479a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb481045f30>]}


============================== 00:38:18.194733 | 78f8260f-ba7e-4720-8860-135c4fafd605 ==============================
[0m00:38:18.194733 [info ] [MainThread]: Running with dbt=1.9.3
[0m00:38:18.195464 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kourosh/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/kourosh/dbt_user_events/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt init', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:38:18.206909 [info ] [MainThread]: Setting up your profile.
[0m00:50:45.773792 [info ] [MainThread]: Profile dbt_user_events written to /home/kourosh/.dbt/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m00:50:45.775847 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 747.6479, "process_in_blocks": "0", "process_kernel_time": 0.426099, "process_mem_max_rss": "240108", "process_out_blocks": "32", "process_user_time": 2.942495}
[0m00:50:45.777326 [debug] [MainThread]: Command `dbt init` succeeded at 00:50:45.777111 after 747.65 seconds
[0m00:50:45.778467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a98e31f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4720d9870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4810468c0>]}
[0m00:50:45.779692 [debug] [MainThread]: Flushing usage events
[0m00:50:46.790773 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:51:02.066130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bdd47f220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bb4bd1f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bb4bd2380>]}


============================== 00:51:02.069021 | c3da3603-164f-4042-9ac3-1a87f36176b6 ==============================
[0m00:51:02.069021 [info ] [MainThread]: Running with dbt=1.9.3
[0m00:51:02.069748 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kourosh/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/kourosh/dbt_user_events/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:51:02.078153 [info ] [MainThread]: dbt version: 1.9.3
[0m00:51:02.078786 [info ] [MainThread]: python version: 3.10.10
[0m00:51:02.079302 [info ] [MainThread]: python path: /home/kourosh/mambaforge/bin/python3.10
[0m00:51:02.079936 [info ] [MainThread]: os info: Linux-5.15.0-136-generic-x86_64-with-glibc2.31
[0m00:51:03.252633 [info ] [MainThread]: Using profiles dir at /home/kourosh/.dbt
[0m00:51:03.253304 [info ] [MainThread]: Using profiles.yml file at /home/kourosh/.dbt/profiles.yml
[0m00:51:03.253893 [info ] [MainThread]: Using dbt_project.yml file at /home/kourosh/dbt_user_events/dbt_project.yml
[0m00:51:03.254435 [info ] [MainThread]: adapter type: bigquery
[0m00:51:03.254949 [info ] [MainThread]: adapter version: 1.9.1
[0m00:51:03.371012 [info ] [MainThread]: Configuration:
[0m00:51:03.371662 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:51:03.372191 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:51:03.372700 [info ] [MainThread]: Required dependencies:
[0m00:51:03.373251 [debug] [MainThread]: Executing "git --help"
[0m00:51:03.375528 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:51:03.376279 [debug] [MainThread]: STDERR: "b''"
[0m00:51:03.376776 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:51:03.377290 [info ] [MainThread]: Connection:
[0m00:51:03.377795 [info ] [MainThread]:   method: service-account
[0m00:51:03.378531 [info ] [MainThread]:   database: user-event-pipeline
[0m00:51:03.379038 [info ] [MainThread]:   execution_project: user-event-pipeline
[0m00:51:03.379531 [info ] [MainThread]:   schema: bq_user_events
[0m00:51:03.380018 [info ] [MainThread]:   location: EU
[0m00:51:03.380506 [info ] [MainThread]:   priority: interactive
[0m00:51:03.381091 [info ] [MainThread]:   maximum_bytes_billed: None
[0m00:51:03.381618 [info ] [MainThread]:   impersonate_service_account: None
[0m00:51:03.382231 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m00:51:03.383064 [info ] [MainThread]:   job_retries: 1
[0m00:51:03.383744 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m00:51:03.384330 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m00:51:03.385019 [info ] [MainThread]:   timeout_seconds: 300
[0m00:51:03.385535 [info ] [MainThread]:   client_id: None
[0m00:51:03.386066 [info ] [MainThread]:   token_uri: None
[0m00:51:03.386599 [info ] [MainThread]:   dataproc_region: None
[0m00:51:03.387129 [info ] [MainThread]:   dataproc_cluster_name: None
[0m00:51:03.387670 [info ] [MainThread]:   gcs_bucket: None
[0m00:51:03.388200 [info ] [MainThread]:   dataproc_batch: None
[0m00:51:03.389036 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m00:51:03.564256 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m00:51:03.564941 [debug] [MainThread]: On debug: select 1 as id
[0m00:51:03.565491 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:51:06.759640 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=user-event-pipeline&j=bq:EU:38eae9f3-6aee-4e28-a082-aa7b7d6b10e7&page=queryresults
[0m00:51:07.278057 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m00:51:07.280845 [info ] [MainThread]: [32mAll checks passed![0m
[0m00:51:07.284294 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 5.281316, "process_in_blocks": "1112", "process_kernel_time": 0.550697, "process_mem_max_rss": "253244", "process_out_blocks": "16", "process_user_time": 3.364479}
[0m00:51:07.287376 [debug] [MainThread]: Command `dbt debug` succeeded at 00:51:07.286891 after 5.28 seconds
[0m00:51:07.289634 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:51:07.293262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bdd47f220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bb4c2fac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ba5c04790>]}
[0m00:51:07.297312 [debug] [MainThread]: Flushing usage events
[0m00:51:07.986953 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:51:15.079560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56f82df280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56cf85a0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56cf85a080>]}


============================== 00:51:15.082527 | 5fc5922c-b707-4f64-b92d-c97fdd375c0c ==============================
[0m00:51:15.082527 [info ] [MainThread]: Running with dbt=1.9.3
[0m00:51:15.083224 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kourosh/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/kourosh/dbt_user_events/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:51:16.447395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fc5922c-b707-4f64-b92d-c97fdd375c0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56fa153400>]}
[0m00:51:16.516192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fc5922c-b707-4f64-b92d-c97fdd375c0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c0c36650>]}
[0m00:51:16.517143 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m00:51:16.698105 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m00:51:16.833171 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:51:16.833892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5fc5922c-b707-4f64-b92d-c97fdd375c0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56cfeef700>]}
[0m00:51:18.386532 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_user_events.hub_event' (models/vault/hub_event.sql) depends on a source named 'bq_user_events.raw_events' which was not found
[0m00:51:18.387495 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.373275, "process_in_blocks": "0", "process_kernel_time": 0.54022, "process_mem_max_rss": "253236", "process_out_blocks": "8", "process_user_time": 5.038058}
[0m00:51:18.388297 [debug] [MainThread]: Command `dbt run` failed at 00:51:18.388162 after 3.37 seconds
[0m00:51:18.388885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56f82df280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c06e8400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56bfbb0d90>]}
[0m00:51:18.389479 [debug] [MainThread]: Flushing usage events
[0m00:51:19.147917 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:52:26.854320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc58b423280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5629a6110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5629a60b0>]}


============================== 00:52:26.859452 | 6c5055a1-0bd7-456b-8e58-23825113a920 ==============================
[0m00:52:26.859452 [info ] [MainThread]: Running with dbt=1.9.3
[0m00:52:26.861059 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/kourosh/dbt_user_events/logs', 'version_check': 'True', 'profiles_dir': '/home/kourosh/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select vault', 'send_anonymous_usage_stats': 'True'}
[0m00:52:28.169229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c5055a1-0bd7-456b-8e58-23825113a920', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc58d29b400>]}
[0m00:52:28.238141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c5055a1-0bd7-456b-8e58-23825113a920', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc553ddaf20>]}
[0m00:52:28.239144 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m00:52:28.410667 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m00:52:28.541514 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:52:28.542201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6c5055a1-0bd7-456b-8e58-23825113a920', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc563037700>]}
[0m00:52:30.066572 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_user_events.hub_event' (models/vault/hub_event.sql) depends on a source named 'bq_user_events.raw_events' which was not found
[0m00:52:30.067468 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.2785017, "process_in_blocks": "0", "process_kernel_time": 0.513818, "process_mem_max_rss": "253408", "process_out_blocks": "8", "process_user_time": 4.891229}
[0m00:52:30.068190 [debug] [MainThread]: Command `dbt run` failed at 00:52:30.068080 after 3.28 seconds
[0m00:52:30.068755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc58b423280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5536bc2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc553610430>]}
[0m00:52:30.069346 [debug] [MainThread]: Flushing usage events
[0m00:52:30.830667 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:54:13.162355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc8b983250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc62f2e020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc62f2dfc0>]}


============================== 00:54:13.165113 | 3ccadd66-cde3-447f-818a-ceddfff498ca ==============================
[0m00:54:13.165113 [info ] [MainThread]: Running with dbt=1.9.3
[0m00:54:13.165982 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kourosh/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/kourosh/dbt_user_events/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select vault', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:54:14.478071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ccadd66-cde3-447f-818a-ceddfff498ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc8d6c32b0>]}
[0m00:54:14.545070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ccadd66-cde3-447f-818a-ceddfff498ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc54303010>]}
[0m00:54:14.545914 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m00:54:14.715806 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m00:54:14.855975 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:54:14.856667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3ccadd66-cde3-447f-818a-ceddfff498ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc635bb6d0>]}
[0m00:54:16.596981 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_user_events.example
[0m00:54:16.611925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ccadd66-cde3-447f-818a-ceddfff498ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc53ddbc40>]}
[0m00:54:16.741598 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kourosh/dbt_user_events/target/manifest.json
[0m00:54:16.743722 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kourosh/dbt_user_events/target/semantic_manifest.json
[0m00:54:16.755808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ccadd66-cde3-447f-818a-ceddfff498ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc53c818d0>]}
[0m00:54:16.756915 [info ] [MainThread]: Found 6 models, 6 data tests, 1 source, 491 macros
[0m00:54:16.757554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ccadd66-cde3-447f-818a-ceddfff498ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc54702800>]}
[0m00:54:16.758825 [info ] [MainThread]: 
[0m00:54:16.759393 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:54:16.759900 [info ] [MainThread]: 
[0m00:54:16.760584 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:54:16.766008 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_user-event-pipeline'
[0m00:54:16.766736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:54:17.229270 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_user-event-pipeline_bq_user_events'
[0m00:54:17.231439 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:54:17.852611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ccadd66-cde3-447f-818a-ceddfff498ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc8d57ece0>]}
[0m00:54:17.855493 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:54:17.913044 [debug] [Thread-1 (]: Began running node model.dbt_user_events.hub_event
[0m00:54:17.913895 [info ] [Thread-1 (]: 1 of 4 START sql table model bq_user_events.hub_event .......................... [RUN]
[0m00:54:17.914611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user-event-pipeline_bq_user_events, now model.dbt_user_events.hub_event)
[0m00:54:17.915208 [debug] [Thread-1 (]: Began compiling node model.dbt_user_events.hub_event
[0m00:54:17.928276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:17.969743 [debug] [Thread-1 (]: Compilation Error in model hub_event (models/vault/hub_event.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:54:17.971700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ccadd66-cde3-447f-818a-ceddfff498ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc63178cd0>]}
[0m00:54:17.972621 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model bq_user_events.hub_event ................. [[31mERROR[0m in 0.06s]
[0m00:54:17.973687 [debug] [Thread-1 (]: Finished running node model.dbt_user_events.hub_event
[0m00:54:17.974291 [debug] [Thread-1 (]: Began running node model.dbt_user_events.hub_user
[0m00:54:17.974957 [info ] [Thread-1 (]: 2 of 4 START sql table model bq_user_events.hub_user ........................... [RUN]
[0m00:54:17.975654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_user_events.hub_event, now model.dbt_user_events.hub_user)
[0m00:54:17.976205 [debug] [Thread-1 (]: Began compiling node model.dbt_user_events.hub_user
[0m00:54:17.980193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:17.980910 [debug] [Thread-4 (]: Marking all children of 'model.dbt_user_events.hub_event' to be skipped because of status 'error'.  Reason: Compilation Error in model hub_event (models/vault/hub_event.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m00:54:18.022387 [debug] [Thread-1 (]: Compilation Error in model hub_user (models/vault/hub_user.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:54:18.023649 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ccadd66-cde3-447f-818a-ceddfff498ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc53326350>]}
[0m00:54:18.025005 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model bq_user_events.hub_user .................. [[31mERROR[0m in 0.05s]
[0m00:54:18.025728 [debug] [Thread-1 (]: Finished running node model.dbt_user_events.hub_user
[0m00:54:18.026297 [debug] [Thread-1 (]: Began running node model.dbt_user_events.link_user_event
[0m00:54:18.026936 [info ] [Thread-1 (]: 3 of 4 START sql table model bq_user_events.link_user_event .................... [RUN]
[0m00:54:18.027577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_user_events.hub_user, now model.dbt_user_events.link_user_event)
[0m00:54:18.028120 [debug] [Thread-1 (]: Began compiling node model.dbt_user_events.link_user_event
[0m00:54:18.028904 [debug] [Thread-4 (]: Marking all children of 'model.dbt_user_events.hub_user' to be skipped because of status 'error'.  Reason: Compilation Error in model hub_user (models/vault/hub_user.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m00:54:18.035752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:18.077852 [debug] [Thread-1 (]: Compilation Error in model link_user_event (models/vault/link_user_event.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:54:18.078636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ccadd66-cde3-447f-818a-ceddfff498ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc53bb8b80>]}
[0m00:54:18.079488 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model bq_user_events.link_user_event ........... [[31mERROR[0m in 0.05s]
[0m00:54:18.080231 [debug] [Thread-1 (]: Finished running node model.dbt_user_events.link_user_event
[0m00:54:18.081009 [debug] [Thread-1 (]: Began running node model.dbt_user_events.sat_event_metadata
[0m00:54:18.081677 [info ] [Thread-1 (]: 4 of 4 START sql table model bq_user_events.sat_event_metadata ................. [RUN]
[0m00:54:18.082341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_user_events.link_user_event, now model.dbt_user_events.sat_event_metadata)
[0m00:54:18.082905 [debug] [Thread-1 (]: Began compiling node model.dbt_user_events.sat_event_metadata
[0m00:54:18.086884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:18.087626 [debug] [Thread-4 (]: Marking all children of 'model.dbt_user_events.link_user_event' to be skipped because of status 'error'.  Reason: Compilation Error in model link_user_event (models/vault/link_user_event.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m00:54:18.129099 [debug] [Thread-1 (]: Compilation Error in model sat_event_metadata (models/vault/sat_event_metadata.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:54:18.129988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ccadd66-cde3-447f-818a-ceddfff498ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc532a2140>]}
[0m00:54:18.130827 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model bq_user_events.sat_event_metadata ........ [[31mERROR[0m in 0.05s]
[0m00:54:18.131558 [debug] [Thread-1 (]: Finished running node model.dbt_user_events.sat_event_metadata
[0m00:54:18.132272 [debug] [Thread-4 (]: Marking all children of 'model.dbt_user_events.sat_event_metadata' to be skipped because of status 'error'.  Reason: Compilation Error in model sat_event_metadata (models/vault/sat_event_metadata.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m00:54:18.133574 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:54:18.173480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:54:18.174075 [debug] [MainThread]: Connection 'list_user-event-pipeline' was properly closed.
[0m00:54:18.174557 [debug] [MainThread]: Connection 'model.dbt_user_events.sat_event_metadata' was properly closed.
[0m00:54:18.175115 [info ] [MainThread]: 
[0m00:54:18.175671 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.41 seconds (1.41s).
[0m00:54:18.176799 [debug] [MainThread]: Command end result
[0m00:54:18.208198 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kourosh/dbt_user_events/target/manifest.json
[0m00:54:18.209852 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kourosh/dbt_user_events/target/semantic_manifest.json
[0m00:54:18.216365 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kourosh/dbt_user_events/target/run_results.json
[0m00:54:18.216922 [info ] [MainThread]: 
[0m00:54:18.217543 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m00:54:18.218134 [info ] [MainThread]: 
[0m00:54:18.218731 [error] [MainThread]:   Compilation Error in model hub_event (models/vault/hub_event.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:54:18.219256 [info ] [MainThread]: 
[0m00:54:18.220014 [error] [MainThread]:   Compilation Error in model hub_user (models/vault/hub_user.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:54:18.220874 [info ] [MainThread]: 
[0m00:54:18.221813 [error] [MainThread]:   Compilation Error in model link_user_event (models/vault/link_user_event.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:54:18.222536 [info ] [MainThread]: 
[0m00:54:18.223766 [error] [MainThread]:   Compilation Error in model sat_event_metadata (models/vault/sat_event_metadata.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:54:18.225035 [info ] [MainThread]: 
[0m00:54:18.226080 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m00:54:18.227649 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.1280284, "process_in_blocks": "0", "process_kernel_time": 0.464353, "process_mem_max_rss": "264512", "process_out_blocks": "3112", "process_user_time": 5.98856}
[0m00:54:18.229181 [debug] [MainThread]: Command `dbt run` failed at 00:54:18.229003 after 5.13 seconds
[0m00:54:18.229795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc8b983250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc540c5e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc63611b40>]}
[0m00:54:18.230431 [debug] [MainThread]: Flushing usage events
[0m00:54:19.271079 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:55:49.346531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d2062f1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cf7d80f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cf7d82a40>]}


============================== 00:55:49.349419 | 3e68cef2-0d8f-4d84-86fd-4ca190d77174 ==============================
[0m00:55:49.349419 [info ] [MainThread]: Running with dbt=1.9.3
[0m00:55:49.350367 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/kourosh/dbt_user_events/logs', 'profiles_dir': '/home/kourosh/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:55:49.513934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e68cef2-0d8f-4d84-86fd-4ca190d77174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cf7ddfdf0>]}
[0m00:55:49.524409 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-7g8nb4p2'
[0m00:55:49.525137 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m00:55:49.790997 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m00:55:49.797163 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m00:55:49.885993 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m00:55:49.956825 [info ] [MainThread]: Updating lock file in file path: /home/kourosh/dbt_user_events/package-lock.yml
[0m00:55:49.959050 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-w455e7c0'
[0m00:55:49.964332 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m00:55:50.377802 [info ] [MainThread]: Installed from version 1.1.1
[0m00:55:50.378476 [info ] [MainThread]: Updated version available: 1.3.0
[0m00:55:50.379066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3e68cef2-0d8f-4d84-86fd-4ca190d77174', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cf7da01f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cf7da18d0>]}
[0m00:55:50.379689 [info ] [MainThread]: 
[0m00:55:50.380238 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m00:55:50.381521 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.100189, "process_in_blocks": "0", "process_kernel_time": 0.371072, "process_mem_max_rss": "129196", "process_out_blocks": "2240", "process_user_time": 2.346138}
[0m00:55:50.382392 [debug] [MainThread]: Command `dbt deps` succeeded at 00:55:50.382217 after 1.10 seconds
[0m00:55:50.383027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d2062f1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d220cefe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d20589de0>]}
[0m00:55:50.383593 [debug] [MainThread]: Flushing usage events
[0m00:55:51.124341 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:56:47.172312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc07e143280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0556c20e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0556c2080>]}


============================== 00:56:47.175488 | 67e6a563-8d6f-44a5-92f1-68f8c13f67e3 ==============================
[0m00:56:47.175488 [info ] [MainThread]: Running with dbt=1.9.3
[0m00:56:47.176212 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/kourosh/.dbt', 'log_path': '/home/kourosh/dbt_user_events/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select vault', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:56:48.511079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67e6a563-8d6f-44a5-92f1-68f8c13f67e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc04691f7f0>]}
[0m00:56:48.593326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67e6a563-8d6f-44a5-92f1-68f8c13f67e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc046ab4520>]}
[0m00:56:48.594194 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m00:56:48.772561 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m00:56:48.906987 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m00:56:48.907733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '67e6a563-8d6f-44a5-92f1-68f8c13f67e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc055d53700>]}
[0m00:56:50.349524 [error] [MainThread]: Encountered an error:
Compilation Error in model hub_event (models/vault/hub_event.sql)
  
  Warning: `dbt_utils.surrogate_key` has been replaced by `dbt_utils.generate_surrogate_key`. The new macro treats null values differently to empty strings. To restore the behaviour of the original macro, add a global variable in dbt_project.yml called `surrogate_key_treat_nulls_as_empty_strings` to your dbt_project.yml file with a value of True. The dbt_user_events.hub_event model triggered this warning. 
  
  > in macro default__surrogate_key (macros/sql/surrogate_key.sql)
  > called by macro surrogate_key (macros/sql/surrogate_key.sql)
  > called by model hub_event (models/vault/hub_event.sql)
[0m00:56:50.350505 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.2416482, "process_in_blocks": "0", "process_kernel_time": 0.539763, "process_mem_max_rss": "253148", "process_out_blocks": "16", "process_user_time": 4.925844}
[0m00:56:50.351255 [debug] [MainThread]: Command `dbt run` failed at 00:56:50.351140 after 3.24 seconds
[0m00:56:50.351839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc07e143280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc07e032d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc046395720>]}
[0m00:56:50.352440 [debug] [MainThread]: Flushing usage events
[0m00:56:51.130919 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:00:19.695689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8eea832e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8c6032110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8c60320b0>]}


============================== 01:00:19.698697 | 489d6aaa-a244-40e4-8018-0538637d1e15 ==============================
[0m01:00:19.698697 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:00:19.699393 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/kourosh/dbt_user_events/logs', 'profiles_dir': '/home/kourosh/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select vault', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:00:21.037115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '489d6aaa-a244-40e4-8018-0538637d1e15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8b7286b60>]}
[0m01:00:21.105496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '489d6aaa-a244-40e4-8018-0538637d1e15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8c6559c60>]}
[0m01:00:21.106379 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m01:00:21.280928 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:00:21.413333 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m01:00:21.413996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '489d6aaa-a244-40e4-8018-0538637d1e15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8c66bfa90>]}
[0m01:00:23.396813 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_user_events.example
[0m01:00:23.410277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '489d6aaa-a244-40e4-8018-0538637d1e15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8b62d0dc0>]}
[0m01:00:23.530183 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kourosh/dbt_user_events/target/manifest.json
[0m01:00:23.531988 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kourosh/dbt_user_events/target/semantic_manifest.json
[0m01:00:23.542490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '489d6aaa-a244-40e4-8018-0538637d1e15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8b62bada0>]}
[0m01:00:23.543248 [info ] [MainThread]: Found 6 models, 6 data tests, 1 source, 605 macros
[0m01:00:23.543820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '489d6aaa-a244-40e4-8018-0538637d1e15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8b62b8af0>]}
[0m01:00:23.545560 [info ] [MainThread]: 
[0m01:00:23.546211 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:00:23.546713 [info ] [MainThread]: 
[0m01:00:23.547394 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:00:23.552597 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_user-event-pipeline'
[0m01:00:23.553540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:24.023638 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user-event-pipeline, now list_user-event-pipeline_bq_user_events)
[0m01:00:24.024339 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:24.647743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '489d6aaa-a244-40e4-8018-0538637d1e15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8f0682860>]}
[0m01:00:24.650648 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:00:24.717221 [debug] [Thread-1 (]: Began running node model.dbt_user_events.hub_event
[0m01:00:24.717988 [info ] [Thread-1 (]: 1 of 4 START sql table model bq_user_events.hub_event .......................... [RUN]
[0m01:00:24.718648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user-event-pipeline_bq_user_events, now model.dbt_user_events.hub_event)
[0m01:00:24.719191 [debug] [Thread-1 (]: Began compiling node model.dbt_user_events.hub_event
[0m01:00:24.731352 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_user_events.hub_event"
[0m01:00:24.732442 [debug] [Thread-1 (]: Began executing node model.dbt_user_events.hub_event
[0m01:00:24.779477 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_user_events.hub_event"
[0m01:00:24.780374 [debug] [Thread-1 (]: On model.dbt_user_events.hub_event: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_user_events", "target_name": "dev", "node_id": "model.dbt_user_events.hub_event"} */

  
    

    create or replace table `user-event-pipeline`.`bq_user_events`.`hub_event`
      
    
    

    OPTIONS()
    as (
      

SELECT DISTINCT
  event_id,
  to_hex(md5(cast(coalesce(cast(event_id as string), '_dbt_utils_surrogate_key_null_') as string))) AS hub_event_id,
  CURRENT_TIMESTAMP() AS load_ts
FROM `user-event-pipeline`.`bq_user_events`.`raw_events`
WHERE event_id IS NOT NULL
    );
  
[0m01:00:24.781053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:25.866572 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=user-event-pipeline&j=bq:EU:0bb7c273-bfad-4b38-922a-31e0adaedd22&page=queryresults
[0m01:00:28.165977 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '489d6aaa-a244-40e4-8018-0538637d1e15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8b741e920>]}
[0m01:00:28.166988 [info ] [Thread-1 (]: 1 of 4 OK created sql table model bq_user_events.hub_event ..................... [[32mCREATE TABLE (10.0 rows, 90.0 Bytes processed)[0m in 3.45s]
[0m01:00:28.167866 [debug] [Thread-1 (]: Finished running node model.dbt_user_events.hub_event
[0m01:00:28.168516 [debug] [Thread-1 (]: Began running node model.dbt_user_events.hub_user
[0m01:00:28.169406 [info ] [Thread-1 (]: 2 of 4 START sql table model bq_user_events.hub_user ........................... [RUN]
[0m01:00:28.170142 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_user_events.hub_event, now model.dbt_user_events.hub_user)
[0m01:00:28.170706 [debug] [Thread-1 (]: Began compiling node model.dbt_user_events.hub_user
[0m01:00:28.176649 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_user_events.hub_user"
[0m01:00:28.177478 [debug] [Thread-1 (]: Began executing node model.dbt_user_events.hub_user
[0m01:00:28.182434 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_user_events.hub_user"
[0m01:00:28.183339 [debug] [Thread-1 (]: On model.dbt_user_events.hub_user: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_user_events", "target_name": "dev", "node_id": "model.dbt_user_events.hub_user"} */

  
    

    create or replace table `user-event-pipeline`.`bq_user_events`.`hub_user`
      
    
    

    OPTIONS()
    as (
      

SELECT DISTINCT
  user_id,
  to_hex(md5(cast(coalesce(cast(event_id as string), '_dbt_utils_surrogate_key_null_') as string))) AS hub_user_id,
  CURRENT_TIMESTAMP() AS load_ts
FROM `user-event-pipeline`.`bq_user_events`.`raw_events`
WHERE user_id IS NOT NULL
    );
  
[0m01:00:28.183959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:28.929536 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=user-event-pipeline&j=bq:EU:47e14c74-13aa-4716-aa8e-138914142c97&page=queryresults
[0m01:00:31.292790 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '489d6aaa-a244-40e4-8018-0538637d1e15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8b62389a0>]}
[0m01:00:31.296756 [info ] [Thread-1 (]: 2 of 4 OK created sql table model bq_user_events.hub_user ...................... [[32mCREATE TABLE (10.0 rows, 190.0 Bytes processed)[0m in 3.12s]
[0m01:00:31.301145 [debug] [Thread-1 (]: Finished running node model.dbt_user_events.hub_user
[0m01:00:31.304220 [debug] [Thread-1 (]: Began running node model.dbt_user_events.link_user_event
[0m01:00:31.307393 [info ] [Thread-1 (]: 3 of 4 START sql table model bq_user_events.link_user_event .................... [RUN]
[0m01:00:31.310590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_user_events.hub_user, now model.dbt_user_events.link_user_event)
[0m01:00:31.312574 [debug] [Thread-1 (]: Began compiling node model.dbt_user_events.link_user_event
[0m01:00:31.327987 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_user_events.link_user_event"
[0m01:00:31.329073 [debug] [Thread-1 (]: Began executing node model.dbt_user_events.link_user_event
[0m01:00:31.333905 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_user_events.link_user_event"
[0m01:00:31.334963 [debug] [Thread-1 (]: On model.dbt_user_events.link_user_event: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_user_events", "target_name": "dev", "node_id": "model.dbt_user_events.link_user_event"} */

  
    

    create or replace table `user-event-pipeline`.`bq_user_events`.`link_user_event`
      
    
    

    OPTIONS()
    as (
      

SELECT DISTINCT
  to_hex(md5(cast(coalesce(cast(user_id as string), '_dbt_utils_surrogate_key_null_') as string))) AS hub_user_id,
  to_hex(md5(cast(coalesce(cast(event_id as string), '_dbt_utils_surrogate_key_null_') as string))) AS hub_event_id,
  CURRENT_TIMESTAMP() AS load_ts
FROM `user-event-pipeline`.`bq_user_events`.`raw_events`
WHERE user_id IS NOT NULL AND event_id IS NOT NULL
    );
  
[0m01:00:31.335804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:32.316431 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=user-event-pipeline&j=bq:EU:45539241-0dae-46bd-9467-cee2562f049b&page=queryresults
[0m01:00:34.684804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '489d6aaa-a244-40e4-8018-0538637d1e15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8b741e920>]}
[0m01:00:34.688652 [info ] [Thread-1 (]: 3 of 4 OK created sql table model bq_user_events.link_user_event ............... [[32mCREATE TABLE (10.0 rows, 190.0 Bytes processed)[0m in 3.37s]
[0m01:00:34.692608 [debug] [Thread-1 (]: Finished running node model.dbt_user_events.link_user_event
[0m01:00:34.694615 [debug] [Thread-1 (]: Began running node model.dbt_user_events.sat_event_metadata
[0m01:00:34.696844 [info ] [Thread-1 (]: 4 of 4 START sql table model bq_user_events.sat_event_metadata ................. [RUN]
[0m01:00:34.698782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_user_events.link_user_event, now model.dbt_user_events.sat_event_metadata)
[0m01:00:34.700021 [debug] [Thread-1 (]: Began compiling node model.dbt_user_events.sat_event_metadata
[0m01:00:34.711407 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_user_events.sat_event_metadata"
[0m01:00:34.712483 [debug] [Thread-1 (]: Began executing node model.dbt_user_events.sat_event_metadata
[0m01:00:34.717175 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_user_events.sat_event_metadata"
[0m01:00:34.720515 [debug] [Thread-1 (]: On model.dbt_user_events.sat_event_metadata: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_user_events", "target_name": "dev", "node_id": "model.dbt_user_events.sat_event_metadata"} */

  
    

    create or replace table `user-event-pipeline`.`bq_user_events`.`sat_event_metadata`
      
    
    

    OPTIONS()
    as (
      

SELECT
  to_hex(md5(cast(coalesce(cast(event_id as string), '_dbt_utils_surrogate_key_null_') as string))) AS hub_event_id,
  event_type,
  page,
  device_type,
  TIMESTAMP(timestamp) AS event_timestamp,
  CURRENT_TIMESTAMP() AS load_ts
FROM `user-event-pipeline`.`bq_user_events`.`raw_events`
    );
  
[0m01:00:34.721377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:35.390072 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=user-event-pipeline&j=bq:EU:fc7fbde9-2a93-401d-a331-f0463404cf94&page=queryresults
[0m01:00:39.703813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '489d6aaa-a244-40e4-8018-0538637d1e15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8eee0ed40>]}
[0m01:00:39.707834 [info ] [Thread-1 (]: 4 of 4 OK created sql table model bq_user_events.sat_event_metadata ............ [[32mCREATE TABLE (10.0 rows, 420.0 Bytes processed)[0m in 5.00s]
[0m01:00:39.711581 [debug] [Thread-1 (]: Finished running node model.dbt_user_events.sat_event_metadata
[0m01:00:39.716790 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:00:39.770134 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:00:39.771021 [debug] [MainThread]: Connection 'model.dbt_user_events.sat_event_metadata' was properly closed.
[0m01:00:39.771634 [info ] [MainThread]: 
[0m01:00:39.772168 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 16.22 seconds (16.22s).
[0m01:00:39.773583 [debug] [MainThread]: Command end result
[0m01:00:39.809899 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kourosh/dbt_user_events/target/manifest.json
[0m01:00:39.811606 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kourosh/dbt_user_events/target/semantic_manifest.json
[0m01:00:39.818518 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kourosh/dbt_user_events/target/run_results.json
[0m01:00:39.819233 [info ] [MainThread]: 
[0m01:00:39.820127 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:00:39.820731 [info ] [MainThread]: 
[0m01:00:39.821348 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m01:00:39.822087 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.194916, "process_in_blocks": "8", "process_kernel_time": 0.593659, "process_mem_max_rss": "268284", "process_out_blocks": "3920", "process_user_time": 6.7215}
[0m01:00:39.822836 [debug] [MainThread]: Command `dbt run` succeeded at 01:00:39.822720 after 20.20 seconds
[0m01:00:39.823393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8eea832e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8b7286b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8b62cd120>]}
[0m01:00:39.823965 [debug] [MainThread]: Flushing usage events
[0m01:00:40.919004 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:16:33.718325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09c27e71f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0999d72170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0999d72110>]}


============================== 13:16:33.721891 | c65088b5-a280-4065-a55a-6c77ad39ed07 ==============================
[0m13:16:33.721891 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:16:33.722637 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kourosh/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/kourosh/user_event_pipeline/dbt_user_events/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:16:35.698247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c65088b5-a280-4065-a55a-6c77ad39ed07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f098afb28f0>]}
[0m13:16:35.765622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c65088b5-a280-4065-a55a-6c77ad39ed07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f099a401d50>]}
[0m13:16:35.766450 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:16:35.936445 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:16:36.122709 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:16:36.123312 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:16:36.130886 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_user_events.example
[0m13:16:36.183931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c65088b5-a280-4065-a55a-6c77ad39ed07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f098ab7ce20>]}
[0m13:16:36.296112 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kourosh/user_event_pipeline/dbt_user_events/target/manifest.json
[0m13:16:36.298089 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kourosh/user_event_pipeline/dbt_user_events/target/semantic_manifest.json
[0m13:16:36.325305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c65088b5-a280-4065-a55a-6c77ad39ed07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f098ab63fa0>]}
[0m13:16:36.326166 [info ] [MainThread]: Found 6 models, 6 data tests, 1 source, 605 macros
[0m13:16:36.326725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c65088b5-a280-4065-a55a-6c77ad39ed07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f098ab7d150>]}
[0m13:16:36.328252 [info ] [MainThread]: 
[0m13:16:36.328816 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:16:36.329312 [info ] [MainThread]: 
[0m13:16:36.329975 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:16:36.335254 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_user-event-pipeline_bq_user_events'
[0m13:16:36.335939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:36.866381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c65088b5-a280-4065-a55a-6c77ad39ed07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f099a3bf3d0>]}
[0m13:16:36.869272 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:16:36.935998 [debug] [Thread-1 (]: Began running node test.dbt_user_events.not_null_hub_event_event_id.e0ec02412d
[0m13:16:36.936652 [info ] [Thread-1 (]: 1 of 6 START test not_null_hub_event_event_id .................................. [RUN]
[0m13:16:36.937341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user-event-pipeline_bq_user_events, now test.dbt_user_events.not_null_hub_event_event_id.e0ec02412d)
[0m13:16:36.937906 [debug] [Thread-1 (]: Began compiling node test.dbt_user_events.not_null_hub_event_event_id.e0ec02412d
[0m13:16:36.957795 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_user_events.not_null_hub_event_event_id.e0ec02412d"
[0m13:16:36.958685 [debug] [Thread-1 (]: Began executing node test.dbt_user_events.not_null_hub_event_event_id.e0ec02412d
[0m13:16:36.980667 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_user_events.not_null_hub_event_event_id.e0ec02412d"
[0m13:16:36.981553 [debug] [Thread-1 (]: On test.dbt_user_events.not_null_hub_event_event_id.e0ec02412d: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_user_events", "target_name": "dev", "node_id": "test.dbt_user_events.not_null_hub_event_event_id.e0ec02412d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from `user-event-pipeline`.`bq_user_events`.`hub_event`
where event_id is null



      
    ) dbt_internal_test
[0m13:16:36.982175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:16:38.082380 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=user-event-pipeline&j=bq:EU:df698e7e-f871-48cc-ad1e-615b748dfa16&page=queryresults
[0m13:16:38.821264 [info ] [Thread-1 (]: 1 of 6 PASS not_null_hub_event_event_id ........................................ [[32mPASS[0m in 1.88s]
[0m13:16:38.823637 [debug] [Thread-1 (]: Finished running node test.dbt_user_events.not_null_hub_event_event_id.e0ec02412d
[0m13:16:38.825775 [debug] [Thread-1 (]: Began running node test.dbt_user_events.not_null_hub_user_user_id.2d4c18c8f3
[0m13:16:38.827158 [info ] [Thread-1 (]: 2 of 6 START test not_null_hub_user_user_id .................................... [RUN]
[0m13:16:38.828526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_user_events.not_null_hub_event_event_id.e0ec02412d, now test.dbt_user_events.not_null_hub_user_user_id.2d4c18c8f3)
[0m13:16:38.829725 [debug] [Thread-1 (]: Began compiling node test.dbt_user_events.not_null_hub_user_user_id.2d4c18c8f3
[0m13:16:38.838029 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_user_events.not_null_hub_user_user_id.2d4c18c8f3"
[0m13:16:38.839055 [debug] [Thread-1 (]: Began executing node test.dbt_user_events.not_null_hub_user_user_id.2d4c18c8f3
[0m13:16:38.843404 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_user_events.not_null_hub_user_user_id.2d4c18c8f3"
[0m13:16:38.844402 [debug] [Thread-1 (]: On test.dbt_user_events.not_null_hub_user_user_id.2d4c18c8f3: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_user_events", "target_name": "dev", "node_id": "test.dbt_user_events.not_null_hub_user_user_id.2d4c18c8f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from `user-event-pipeline`.`bq_user_events`.`hub_user`
where user_id is null



      
    ) dbt_internal_test
[0m13:16:38.845136 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:16:39.877168 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=user-event-pipeline&j=bq:EU:1600ce63-4a91-4297-baaf-54a8ced1a223&page=queryresults
[0m13:16:40.446045 [info ] [Thread-1 (]: 2 of 6 PASS not_null_hub_user_user_id .......................................... [[32mPASS[0m in 1.62s]
[0m13:16:40.449492 [debug] [Thread-1 (]: Finished running node test.dbt_user_events.not_null_hub_user_user_id.2d4c18c8f3
[0m13:16:40.451838 [debug] [Thread-1 (]: Began running node test.dbt_user_events.not_null_link_user_event_hub_event_id.3bcb9ac203
[0m13:16:40.454736 [info ] [Thread-1 (]: 3 of 6 START test not_null_link_user_event_hub_event_id ........................ [RUN]
[0m13:16:40.457877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_user_events.not_null_hub_user_user_id.2d4c18c8f3, now test.dbt_user_events.not_null_link_user_event_hub_event_id.3bcb9ac203)
[0m13:16:40.460268 [debug] [Thread-1 (]: Began compiling node test.dbt_user_events.not_null_link_user_event_hub_event_id.3bcb9ac203
[0m13:16:40.474532 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_user_events.not_null_link_user_event_hub_event_id.3bcb9ac203"
[0m13:16:40.476403 [debug] [Thread-1 (]: Began executing node test.dbt_user_events.not_null_link_user_event_hub_event_id.3bcb9ac203
[0m13:16:40.482368 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_user_events.not_null_link_user_event_hub_event_id.3bcb9ac203"
[0m13:16:40.483572 [debug] [Thread-1 (]: On test.dbt_user_events.not_null_link_user_event_hub_event_id.3bcb9ac203: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_user_events", "target_name": "dev", "node_id": "test.dbt_user_events.not_null_link_user_event_hub_event_id.3bcb9ac203"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select hub_event_id
from `user-event-pipeline`.`bq_user_events`.`link_user_event`
where hub_event_id is null



      
    ) dbt_internal_test
[0m13:16:40.484405 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:16:41.463001 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=user-event-pipeline&j=bq:EU:ba02a764-af4d-44b6-9ffe-dd4464cea497&page=queryresults
[0m13:16:42.082743 [info ] [Thread-1 (]: 3 of 6 PASS not_null_link_user_event_hub_event_id .............................. [[32mPASS[0m in 1.62s]
[0m13:16:42.086785 [debug] [Thread-1 (]: Finished running node test.dbt_user_events.not_null_link_user_event_hub_event_id.3bcb9ac203
[0m13:16:42.089958 [debug] [Thread-1 (]: Began running node test.dbt_user_events.not_null_link_user_event_hub_user_id.9aa782b95d
[0m13:16:42.093068 [info ] [Thread-1 (]: 4 of 6 START test not_null_link_user_event_hub_user_id ......................... [RUN]
[0m13:16:42.096849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_user_events.not_null_link_user_event_hub_event_id.3bcb9ac203, now test.dbt_user_events.not_null_link_user_event_hub_user_id.9aa782b95d)
[0m13:16:42.099401 [debug] [Thread-1 (]: Began compiling node test.dbt_user_events.not_null_link_user_event_hub_user_id.9aa782b95d
[0m13:16:42.112525 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_user_events.not_null_link_user_event_hub_user_id.9aa782b95d"
[0m13:16:42.113835 [debug] [Thread-1 (]: Began executing node test.dbt_user_events.not_null_link_user_event_hub_user_id.9aa782b95d
[0m13:16:42.118723 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_user_events.not_null_link_user_event_hub_user_id.9aa782b95d"
[0m13:16:42.119907 [debug] [Thread-1 (]: On test.dbt_user_events.not_null_link_user_event_hub_user_id.9aa782b95d: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_user_events", "target_name": "dev", "node_id": "test.dbt_user_events.not_null_link_user_event_hub_user_id.9aa782b95d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select hub_user_id
from `user-event-pipeline`.`bq_user_events`.`link_user_event`
where hub_user_id is null



      
    ) dbt_internal_test
[0m13:16:42.120797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:16:42.929925 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=user-event-pipeline&j=bq:EU:dc4d22b8-ea2b-40b6-98b1-fc5ea1514cc9&page=queryresults
[0m13:16:43.513199 [info ] [Thread-1 (]: 4 of 6 PASS not_null_link_user_event_hub_user_id ............................... [[32mPASS[0m in 1.42s]
[0m13:16:43.514279 [debug] [Thread-1 (]: Finished running node test.dbt_user_events.not_null_link_user_event_hub_user_id.9aa782b95d
[0m13:16:43.515007 [debug] [Thread-1 (]: Began running node test.dbt_user_events.unique_hub_event_event_id.2f5fd502cd
[0m13:16:43.515701 [info ] [Thread-1 (]: 5 of 6 START test unique_hub_event_event_id .................................... [RUN]
[0m13:16:43.516493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_user_events.not_null_link_user_event_hub_user_id.9aa782b95d, now test.dbt_user_events.unique_hub_event_event_id.2f5fd502cd)
[0m13:16:43.517193 [debug] [Thread-1 (]: Began compiling node test.dbt_user_events.unique_hub_event_event_id.2f5fd502cd
[0m13:16:43.526417 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_user_events.unique_hub_event_event_id.2f5fd502cd"
[0m13:16:43.527342 [debug] [Thread-1 (]: Began executing node test.dbt_user_events.unique_hub_event_event_id.2f5fd502cd
[0m13:16:43.531056 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_user_events.unique_hub_event_event_id.2f5fd502cd"
[0m13:16:43.531895 [debug] [Thread-1 (]: On test.dbt_user_events.unique_hub_event_event_id.2f5fd502cd: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_user_events", "target_name": "dev", "node_id": "test.dbt_user_events.unique_hub_event_event_id.2f5fd502cd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select event_id as unique_field
  from `user-event-pipeline`.`bq_user_events`.`hub_event`
  where event_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m13:16:43.532559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:16:44.501746 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=user-event-pipeline&j=bq:EU:95676628-2f95-4095-ba55-ebcacb2d629d&page=queryresults
[0m13:16:44.927760 [info ] [Thread-1 (]: 5 of 6 PASS unique_hub_event_event_id .......................................... [[32mPASS[0m in 1.41s]
[0m13:16:44.931211 [debug] [Thread-1 (]: Finished running node test.dbt_user_events.unique_hub_event_event_id.2f5fd502cd
[0m13:16:44.933626 [debug] [Thread-1 (]: Began running node test.dbt_user_events.unique_hub_user_user_id.78f099b9b1
[0m13:16:44.935899 [info ] [Thread-1 (]: 6 of 6 START test unique_hub_user_user_id ...................................... [RUN]
[0m13:16:44.939131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_user_events.unique_hub_event_event_id.2f5fd502cd, now test.dbt_user_events.unique_hub_user_user_id.78f099b9b1)
[0m13:16:44.941679 [debug] [Thread-1 (]: Began compiling node test.dbt_user_events.unique_hub_user_user_id.78f099b9b1
[0m13:16:44.955997 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_user_events.unique_hub_user_user_id.78f099b9b1"
[0m13:16:44.958058 [debug] [Thread-1 (]: Began executing node test.dbt_user_events.unique_hub_user_user_id.78f099b9b1
[0m13:16:44.965983 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_user_events.unique_hub_user_user_id.78f099b9b1"
[0m13:16:44.967061 [debug] [Thread-1 (]: On test.dbt_user_events.unique_hub_user_user_id.78f099b9b1: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_user_events", "target_name": "dev", "node_id": "test.dbt_user_events.unique_hub_user_user_id.78f099b9b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select user_id as unique_field
  from `user-event-pipeline`.`bq_user_events`.`hub_user`
  where user_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m13:16:44.967792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:16:45.837566 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=user-event-pipeline&j=bq:EU:d2a6ffd0-e8d3-4f6c-9fe7-8fee279bb3e4&page=queryresults
[0m13:16:46.484312 [error] [Thread-1 (]: 6 of 6 FAIL 3 unique_hub_user_user_id .......................................... [[31mFAIL 3[0m in 1.54s]
[0m13:16:46.488184 [debug] [Thread-1 (]: Finished running node test.dbt_user_events.unique_hub_user_user_id.78f099b9b1
[0m13:16:46.493130 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:16:46.552310 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:16:46.552921 [debug] [MainThread]: Connection 'test.dbt_user_events.unique_hub_user_user_id.78f099b9b1' was properly closed.
[0m13:16:46.553468 [info ] [MainThread]: 
[0m13:16:46.554034 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 10.22 seconds (10.22s).
[0m13:16:46.555801 [debug] [MainThread]: Command end result
[0m13:16:46.604823 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kourosh/user_event_pipeline/dbt_user_events/target/manifest.json
[0m13:16:46.607558 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kourosh/user_event_pipeline/dbt_user_events/target/semantic_manifest.json
[0m13:16:46.622041 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kourosh/user_event_pipeline/dbt_user_events/target/run_results.json
[0m13:16:46.623027 [info ] [MainThread]: 
[0m13:16:46.624004 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:16:46.624853 [info ] [MainThread]: 
[0m13:16:46.625434 [error] [MainThread]: [31mFailure in test unique_hub_user_user_id (models/staging/schema.yml)[0m
[0m13:16:46.625995 [error] [MainThread]:   Got 3 results, configured to fail if != 0
[0m13:16:46.626477 [info ] [MainThread]: 
[0m13:16:46.627029 [info ] [MainThread]:   compiled code at target/compiled/dbt_user_events/models/staging/schema.yml/unique_hub_user_user_id.sql
[0m13:16:46.627525 [info ] [MainThread]: 
[0m13:16:46.628039 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m13:16:46.628813 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 12.970501, "process_in_blocks": "344728", "process_kernel_time": 0.75494, "process_mem_max_rss": "262352", "process_out_blocks": "2704", "process_user_time": 5.019762}
[0m13:16:46.629528 [debug] [MainThread]: Command `dbt test` failed at 13:16:46.629419 after 12.97 seconds
[0m13:16:46.630095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09c27e71f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f098ab638e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f098ab620e0>]}
[0m13:16:46.630670 [debug] [MainThread]: Flushing usage events
[0m13:16:47.603839 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:20:32.698041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3f9a9f160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3d10260e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3d1026080>]}


============================== 13:20:32.700886 | 0e4e6c04-77a5-4ff5-899c-cc1ebb9a0c8d ==============================
[0m13:20:32.700886 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:20:32.701842 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/kourosh/user_event_pipeline/dbt/logs', 'debug': 'False', 'profiles_dir': '/home/kourosh/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m13:20:33.967930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e4e6c04-77a5-4ff5-899c-cc1ebb9a0c8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3c224caf0>]}
[0m13:20:34.035357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e4e6c04-77a5-4ff5-899c-cc1ebb9a0c8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3d1677640>]}
[0m13:20:34.036182 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:20:34.208103 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:20:34.374004 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:20:34.374619 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:20:34.381912 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_user_events.example
[0m13:20:34.436667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e4e6c04-77a5-4ff5-899c-cc1ebb9a0c8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3c1e18d60>]}
[0m13:20:34.548439 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kourosh/user_event_pipeline/dbt/target/manifest.json
[0m13:20:34.550462 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kourosh/user_event_pipeline/dbt/target/semantic_manifest.json
[0m13:20:34.572330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e4e6c04-77a5-4ff5-899c-cc1ebb9a0c8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3c1dffeb0>]}
[0m13:20:34.573042 [info ] [MainThread]: Found 6 models, 6 data tests, 1 source, 605 macros
[0m13:20:34.573613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e4e6c04-77a5-4ff5-899c-cc1ebb9a0c8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3c1e73010>]}
[0m13:20:34.575269 [info ] [MainThread]: 
[0m13:20:34.575865 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:20:34.576381 [info ] [MainThread]: 
[0m13:20:34.577119 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:20:34.583115 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_user-event-pipeline_bq_user_events'
[0m13:20:34.584117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:35.151989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e4e6c04-77a5-4ff5-899c-cc1ebb9a0c8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3c224c640>]}
[0m13:20:35.154591 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:20:35.220096 [debug] [Thread-1 (]: Began running node test.dbt_user_events.not_null_hub_event_event_id.e0ec02412d
[0m13:20:35.220756 [info ] [Thread-1 (]: 1 of 6 START test not_null_hub_event_event_id .................................. [RUN]
[0m13:20:35.221417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user-event-pipeline_bq_user_events, now test.dbt_user_events.not_null_hub_event_event_id.e0ec02412d)
[0m13:20:35.221972 [debug] [Thread-1 (]: Began compiling node test.dbt_user_events.not_null_hub_event_event_id.e0ec02412d
[0m13:20:35.242194 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_user_events.not_null_hub_event_event_id.e0ec02412d"
[0m13:20:35.242994 [debug] [Thread-1 (]: Began executing node test.dbt_user_events.not_null_hub_event_event_id.e0ec02412d
[0m13:20:35.266273 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_user_events.not_null_hub_event_event_id.e0ec02412d"
[0m13:20:35.267273 [debug] [Thread-1 (]: On test.dbt_user_events.not_null_hub_event_event_id.e0ec02412d: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_user_events", "target_name": "dev", "node_id": "test.dbt_user_events.not_null_hub_event_event_id.e0ec02412d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from `user-event-pipeline`.`bq_user_events`.`hub_event`
where event_id is null



      
    ) dbt_internal_test
[0m13:20:35.267889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:35.830287 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=user-event-pipeline&j=bq:EU:e9c1a6ef-ed7a-4737-84a6-1f72a5dc87eb&page=queryresults
[0m13:20:36.498570 [info ] [Thread-1 (]: 1 of 6 PASS not_null_hub_event_event_id ........................................ [[32mPASS[0m in 1.28s]
[0m13:20:36.501095 [debug] [Thread-1 (]: Finished running node test.dbt_user_events.not_null_hub_event_event_id.e0ec02412d
[0m13:20:36.502296 [debug] [Thread-1 (]: Began running node test.dbt_user_events.not_null_hub_user_user_id.2d4c18c8f3
[0m13:20:36.503422 [info ] [Thread-1 (]: 2 of 6 START test not_null_hub_user_user_id .................................... [RUN]
[0m13:20:36.504513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_user_events.not_null_hub_event_event_id.e0ec02412d, now test.dbt_user_events.not_null_hub_user_user_id.2d4c18c8f3)
[0m13:20:36.505470 [debug] [Thread-1 (]: Began compiling node test.dbt_user_events.not_null_hub_user_user_id.2d4c18c8f3
[0m13:20:36.512621 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_user_events.not_null_hub_user_user_id.2d4c18c8f3"
[0m13:20:36.513566 [debug] [Thread-1 (]: Began executing node test.dbt_user_events.not_null_hub_user_user_id.2d4c18c8f3
[0m13:20:36.517680 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_user_events.not_null_hub_user_user_id.2d4c18c8f3"
[0m13:20:36.518687 [debug] [Thread-1 (]: On test.dbt_user_events.not_null_hub_user_user_id.2d4c18c8f3: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_user_events", "target_name": "dev", "node_id": "test.dbt_user_events.not_null_hub_user_user_id.2d4c18c8f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from `user-event-pipeline`.`bq_user_events`.`hub_user`
where user_id is null



      
    ) dbt_internal_test
[0m13:20:36.519331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:37.391168 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=user-event-pipeline&j=bq:EU:50e0794d-85bb-41a1-98ae-0591a3ab9391&page=queryresults
[0m13:20:38.010433 [info ] [Thread-1 (]: 2 of 6 PASS not_null_hub_user_user_id .......................................... [[32mPASS[0m in 1.50s]
[0m13:20:38.013789 [debug] [Thread-1 (]: Finished running node test.dbt_user_events.not_null_hub_user_user_id.2d4c18c8f3
[0m13:20:38.016145 [debug] [Thread-1 (]: Began running node test.dbt_user_events.not_null_link_user_event_hub_event_id.3bcb9ac203
[0m13:20:38.018731 [info ] [Thread-1 (]: 3 of 6 START test not_null_link_user_event_hub_event_id ........................ [RUN]
[0m13:20:38.021309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_user_events.not_null_hub_user_user_id.2d4c18c8f3, now test.dbt_user_events.not_null_link_user_event_hub_event_id.3bcb9ac203)
[0m13:20:38.024583 [debug] [Thread-1 (]: Began compiling node test.dbt_user_events.not_null_link_user_event_hub_event_id.3bcb9ac203
[0m13:20:38.040239 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_user_events.not_null_link_user_event_hub_event_id.3bcb9ac203"
[0m13:20:38.041956 [debug] [Thread-1 (]: Began executing node test.dbt_user_events.not_null_link_user_event_hub_event_id.3bcb9ac203
[0m13:20:38.047290 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_user_events.not_null_link_user_event_hub_event_id.3bcb9ac203"
[0m13:20:38.048403 [debug] [Thread-1 (]: On test.dbt_user_events.not_null_link_user_event_hub_event_id.3bcb9ac203: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_user_events", "target_name": "dev", "node_id": "test.dbt_user_events.not_null_link_user_event_hub_event_id.3bcb9ac203"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select hub_event_id
from `user-event-pipeline`.`bq_user_events`.`link_user_event`
where hub_event_id is null



      
    ) dbt_internal_test
[0m13:20:38.049300 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:38.927844 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=user-event-pipeline&j=bq:EU:ca462365-0c2b-4994-92fc-93deae375a1a&page=queryresults
[0m13:20:39.550731 [info ] [Thread-1 (]: 3 of 6 PASS not_null_link_user_event_hub_event_id .............................. [[32mPASS[0m in 1.53s]
[0m13:20:39.554514 [debug] [Thread-1 (]: Finished running node test.dbt_user_events.not_null_link_user_event_hub_event_id.3bcb9ac203
[0m13:20:39.557218 [debug] [Thread-1 (]: Began running node test.dbt_user_events.not_null_link_user_event_hub_user_id.9aa782b95d
[0m13:20:39.560014 [info ] [Thread-1 (]: 4 of 6 START test not_null_link_user_event_hub_user_id ......................... [RUN]
[0m13:20:39.563054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_user_events.not_null_link_user_event_hub_event_id.3bcb9ac203, now test.dbt_user_events.not_null_link_user_event_hub_user_id.9aa782b95d)
[0m13:20:39.565926 [debug] [Thread-1 (]: Began compiling node test.dbt_user_events.not_null_link_user_event_hub_user_id.9aa782b95d
[0m13:20:39.580959 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_user_events.not_null_link_user_event_hub_user_id.9aa782b95d"
[0m13:20:39.582735 [debug] [Thread-1 (]: Began executing node test.dbt_user_events.not_null_link_user_event_hub_user_id.9aa782b95d
[0m13:20:39.587546 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_user_events.not_null_link_user_event_hub_user_id.9aa782b95d"
[0m13:20:39.588748 [debug] [Thread-1 (]: On test.dbt_user_events.not_null_link_user_event_hub_user_id.9aa782b95d: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_user_events", "target_name": "dev", "node_id": "test.dbt_user_events.not_null_link_user_event_hub_user_id.9aa782b95d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select hub_user_id
from `user-event-pipeline`.`bq_user_events`.`link_user_event`
where hub_user_id is null



      
    ) dbt_internal_test
[0m13:20:39.589498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:40.463388 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=user-event-pipeline&j=bq:EU:44af6ee2-a775-41d5-b969-38bafb794cb2&page=queryresults
[0m13:20:40.982800 [info ] [Thread-1 (]: 4 of 6 PASS not_null_link_user_event_hub_user_id ............................... [[32mPASS[0m in 1.42s]
[0m13:20:40.986144 [debug] [Thread-1 (]: Finished running node test.dbt_user_events.not_null_link_user_event_hub_user_id.9aa782b95d
[0m13:20:40.988505 [debug] [Thread-1 (]: Began running node test.dbt_user_events.unique_hub_event_event_id.2f5fd502cd
[0m13:20:40.990967 [info ] [Thread-1 (]: 5 of 6 START test unique_hub_event_event_id .................................... [RUN]
[0m13:20:40.993504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_user_events.not_null_link_user_event_hub_user_id.9aa782b95d, now test.dbt_user_events.unique_hub_event_event_id.2f5fd502cd)
[0m13:20:40.995753 [debug] [Thread-1 (]: Began compiling node test.dbt_user_events.unique_hub_event_event_id.2f5fd502cd
[0m13:20:41.014881 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_user_events.unique_hub_event_event_id.2f5fd502cd"
[0m13:20:41.016212 [debug] [Thread-1 (]: Began executing node test.dbt_user_events.unique_hub_event_event_id.2f5fd502cd
[0m13:20:41.021036 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_user_events.unique_hub_event_event_id.2f5fd502cd"
[0m13:20:41.022128 [debug] [Thread-1 (]: On test.dbt_user_events.unique_hub_event_event_id.2f5fd502cd: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_user_events", "target_name": "dev", "node_id": "test.dbt_user_events.unique_hub_event_event_id.2f5fd502cd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select event_id as unique_field
  from `user-event-pipeline`.`bq_user_events`.`hub_event`
  where event_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m13:20:41.022847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:41.997352 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=user-event-pipeline&j=bq:EU:f757e610-208e-4e76-8130-cb10f2869d12&page=queryresults
[0m13:20:42.376448 [info ] [Thread-1 (]: 5 of 6 PASS unique_hub_event_event_id .......................................... [[32mPASS[0m in 1.38s]
[0m13:20:42.380143 [debug] [Thread-1 (]: Finished running node test.dbt_user_events.unique_hub_event_event_id.2f5fd502cd
[0m13:20:42.382789 [debug] [Thread-1 (]: Began running node test.dbt_user_events.unique_hub_user_user_id.78f099b9b1
[0m13:20:42.385342 [info ] [Thread-1 (]: 6 of 6 START test unique_hub_user_user_id ...................................... [RUN]
[0m13:20:42.387712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_user_events.unique_hub_event_event_id.2f5fd502cd, now test.dbt_user_events.unique_hub_user_user_id.78f099b9b1)
[0m13:20:42.389839 [debug] [Thread-1 (]: Began compiling node test.dbt_user_events.unique_hub_user_user_id.78f099b9b1
[0m13:20:42.400635 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_user_events.unique_hub_user_user_id.78f099b9b1"
[0m13:20:42.401884 [debug] [Thread-1 (]: Began executing node test.dbt_user_events.unique_hub_user_user_id.78f099b9b1
[0m13:20:42.408334 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_user_events.unique_hub_user_user_id.78f099b9b1"
[0m13:20:42.409500 [debug] [Thread-1 (]: On test.dbt_user_events.unique_hub_user_user_id.78f099b9b1: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_user_events", "target_name": "dev", "node_id": "test.dbt_user_events.unique_hub_user_user_id.78f099b9b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select user_id as unique_field
  from `user-event-pipeline`.`bq_user_events`.`hub_user`
  where user_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m13:20:42.410245 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:43.227700 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=user-event-pipeline&j=bq:EU:6895084c-e7e8-468f-9e80-0c9a7eba1d20&page=queryresults
[0m13:20:43.745234 [error] [Thread-1 (]: 6 of 6 FAIL 3 unique_hub_user_user_id .......................................... [[31mFAIL 3[0m in 1.36s]
[0m13:20:43.749083 [debug] [Thread-1 (]: Finished running node test.dbt_user_events.unique_hub_user_user_id.78f099b9b1
[0m13:20:43.753642 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:20:43.794969 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:20:43.795574 [debug] [MainThread]: Connection 'test.dbt_user_events.unique_hub_user_user_id.78f099b9b1' was properly closed.
[0m13:20:43.796138 [info ] [MainThread]: 
[0m13:20:43.796826 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 9.22 seconds (9.22s).
[0m13:20:43.798597 [debug] [MainThread]: Command end result
[0m13:20:43.830650 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kourosh/user_event_pipeline/dbt/target/manifest.json
[0m13:20:43.832467 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kourosh/user_event_pipeline/dbt/target/semantic_manifest.json
[0m13:20:43.840370 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kourosh/user_event_pipeline/dbt/target/run_results.json
[0m13:20:43.840940 [info ] [MainThread]: 
[0m13:20:43.841491 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:20:43.841993 [info ] [MainThread]: 
[0m13:20:43.842556 [error] [MainThread]: [31mFailure in test unique_hub_user_user_id (models/staging/schema.yml)[0m
[0m13:20:43.843104 [error] [MainThread]:   Got 3 results, configured to fail if != 0
[0m13:20:43.843573 [info ] [MainThread]: 
[0m13:20:43.844112 [info ] [MainThread]:   compiled code at target/compiled/dbt_user_events/models/staging/schema.yml/unique_hub_user_user_id.sql
[0m13:20:43.844670 [info ] [MainThread]: 
[0m13:20:43.845204 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m13:20:43.845946 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 11.212342, "process_in_blocks": "0", "process_kernel_time": 0.539597, "process_mem_max_rss": "263228", "process_out_blocks": "2704", "process_user_time": 4.964298}
[0m13:20:43.846689 [debug] [MainThread]: Command `dbt test` failed at 13:20:43.846566 after 11.21 seconds
[0m13:20:43.847287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3f9a9f160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3c1e703d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3c1dfea10>]}
[0m13:20:43.847892 [debug] [MainThread]: Flushing usage events
[0m13:20:44.557860 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:21:29.097394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc90e86b190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e5f6fd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e5f6db40>]}


============================== 13:21:29.100199 | 38c94b81-9944-4b77-927d-b85dd6f150c4 ==============================
[0m13:21:29.100199 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:21:29.101007 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/kourosh/user_event_pipeline/dbt/logs', 'profiles_dir': '/home/kourosh/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:21:29.111018 [info ] [MainThread]: dbt version: 1.9.3
[0m13:21:29.112090 [info ] [MainThread]: python version: 3.10.10
[0m13:21:29.113247 [info ] [MainThread]: python path: /home/kourosh/mambaforge/bin/python3.10
[0m13:21:29.114038 [info ] [MainThread]: os info: Linux-5.15.0-136-generic-x86_64-with-glibc2.31
[0m13:21:30.305214 [info ] [MainThread]: Using profiles dir at /home/kourosh/.dbt
[0m13:21:30.305871 [info ] [MainThread]: Using profiles.yml file at /home/kourosh/.dbt/profiles.yml
[0m13:21:30.306400 [info ] [MainThread]: Using dbt_project.yml file at /home/kourosh/user_event_pipeline/dbt/dbt_project.yml
[0m13:21:30.306913 [info ] [MainThread]: adapter type: bigquery
[0m13:21:30.307396 [info ] [MainThread]: adapter version: 1.9.1
[0m13:21:30.432595 [info ] [MainThread]: Configuration:
[0m13:21:30.433267 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:21:30.433779 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:21:30.434275 [info ] [MainThread]: Required dependencies:
[0m13:21:30.434784 [debug] [MainThread]: Executing "git --help"
[0m13:21:30.446526 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:21:30.447189 [debug] [MainThread]: STDERR: "b''"
[0m13:21:30.447671 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:21:30.448204 [info ] [MainThread]: Connection:
[0m13:21:30.448848 [info ] [MainThread]:   method: service-account
[0m13:21:30.449337 [info ] [MainThread]:   database: user-event-pipeline
[0m13:21:30.449821 [info ] [MainThread]:   execution_project: user-event-pipeline
[0m13:21:30.450301 [info ] [MainThread]:   schema: bq_user_events
[0m13:21:30.450780 [info ] [MainThread]:   location: EU
[0m13:21:30.451257 [info ] [MainThread]:   priority: interactive
[0m13:21:30.451734 [info ] [MainThread]:   maximum_bytes_billed: None
[0m13:21:30.452212 [info ] [MainThread]:   impersonate_service_account: None
[0m13:21:30.452699 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m13:21:30.453180 [info ] [MainThread]:   job_retries: 1
[0m13:21:30.453662 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m13:21:30.454170 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m13:21:30.454681 [info ] [MainThread]:   timeout_seconds: 300
[0m13:21:30.455194 [info ] [MainThread]:   client_id: None
[0m13:21:30.455700 [info ] [MainThread]:   token_uri: None
[0m13:21:30.456206 [info ] [MainThread]:   dataproc_region: None
[0m13:21:30.456803 [info ] [MainThread]:   dataproc_cluster_name: None
[0m13:21:30.457430 [info ] [MainThread]:   gcs_bucket: None
[0m13:21:30.458216 [info ] [MainThread]:   dataproc_batch: None
[0m13:21:30.459020 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:21:30.625124 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m13:21:30.625738 [debug] [MainThread]: On debug: select 1 as id
[0m13:21:30.626263 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:21:31.457677 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=user-event-pipeline&j=bq:EU:885e0b23-e010-4155-a357-a8ffacd2f84d&page=queryresults
[0m13:21:31.872497 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:21:31.874849 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:21:31.877692 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.8397684, "process_in_blocks": "80", "process_kernel_time": 0.492083, "process_mem_max_rss": "253288", "process_out_blocks": "24", "process_user_time": 3.352568}
[0m13:21:31.880986 [debug] [MainThread]: Command `dbt debug` succeeded at 13:21:31.880508 after 2.84 seconds
[0m13:21:31.882961 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:21:31.885088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc90e86b190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d70bc490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e64b7130>]}
[0m13:21:31.887840 [debug] [MainThread]: Flushing usage events
[0m13:21:32.691649 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:21:39.580442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7229771c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6fa0d9360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6fa0daaa0>]}


============================== 13:21:39.584852 | 1a66dc46-557d-4e10-8620-f37a6c0895de ==============================
[0m13:21:39.584852 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:21:39.585526 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kourosh/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/kourosh/user_event_pipeline/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select vault', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:21:40.856150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a66dc46-557d-4e10-8620-f37a6c0895de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6fa0929e0>]}
[0m13:21:40.922648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a66dc46-557d-4e10-8620-f37a6c0895de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6eb3299c0>]}
[0m13:21:40.923507 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:21:41.096288 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:21:41.251686 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:21:41.252292 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:21:41.261344 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_user_events.example
[0m13:21:41.315746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a66dc46-557d-4e10-8620-f37a6c0895de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6ead08c10>]}
[0m13:21:41.427447 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kourosh/user_event_pipeline/dbt/target/manifest.json
[0m13:21:41.429242 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kourosh/user_event_pipeline/dbt/target/semantic_manifest.json
[0m13:21:41.439379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a66dc46-557d-4e10-8620-f37a6c0895de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6ead08c40>]}
[0m13:21:41.440119 [info ] [MainThread]: Found 6 models, 6 data tests, 1 source, 605 macros
[0m13:21:41.440837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a66dc46-557d-4e10-8620-f37a6c0895de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6ead08d90>]}
[0m13:21:41.442137 [info ] [MainThread]: 
[0m13:21:41.442725 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:21:41.443259 [info ] [MainThread]: 
[0m13:21:41.443942 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:21:41.448979 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_user-event-pipeline'
[0m13:21:41.449629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:41.912868 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user-event-pipeline, now list_user-event-pipeline_bq_user_events)
[0m13:21:41.915039 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:21:42.528895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a66dc46-557d-4e10-8620-f37a6c0895de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa72456eaa0>]}
[0m13:21:42.531401 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:21:42.598295 [debug] [Thread-1 (]: Began running node model.dbt_user_events.hub_event
[0m13:21:42.599048 [info ] [Thread-1 (]: 1 of 4 START sql table model bq_user_events.hub_event .......................... [RUN]
[0m13:21:42.599691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user-event-pipeline_bq_user_events, now model.dbt_user_events.hub_event)
[0m13:21:42.600238 [debug] [Thread-1 (]: Began compiling node model.dbt_user_events.hub_event
[0m13:21:42.625521 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_user_events.hub_event"
[0m13:21:42.626599 [debug] [Thread-1 (]: Began executing node model.dbt_user_events.hub_event
[0m13:21:42.642722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:43.131309 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_user_events.hub_event"
[0m13:21:43.132262 [debug] [Thread-1 (]: On model.dbt_user_events.hub_event: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_user_events", "target_name": "dev", "node_id": "model.dbt_user_events.hub_event"} */

  
    

    create or replace table `user-event-pipeline`.`bq_user_events`.`hub_event`
      
    
    

    OPTIONS()
    as (
      

SELECT DISTINCT
  event_id,
  to_hex(md5(cast(coalesce(cast(event_id as string), '_dbt_utils_surrogate_key_null_') as string))) AS hub_event_id,
  CURRENT_TIMESTAMP() AS load_ts
FROM `user-event-pipeline`.`bq_user_events`.`raw_events`
WHERE event_id IS NOT NULL
    );
  
[0m13:21:43.686610 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=user-event-pipeline&j=bq:EU:f3ee4767-8a58-4a2a-9402-46663cbb2feb&page=queryresults
[0m13:21:46.562973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a66dc46-557d-4e10-8620-f37a6c0895de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7237de4d0>]}
[0m13:21:46.563957 [info ] [Thread-1 (]: 1 of 4 OK created sql table model bq_user_events.hub_event ..................... [[32mCREATE TABLE (10.0 rows, 90.0 Bytes processed)[0m in 3.96s]
[0m13:21:46.564865 [debug] [Thread-1 (]: Finished running node model.dbt_user_events.hub_event
[0m13:21:46.565505 [debug] [Thread-1 (]: Began running node model.dbt_user_events.hub_user
[0m13:21:46.566263 [info ] [Thread-1 (]: 2 of 4 START sql table model bq_user_events.hub_user ........................... [RUN]
[0m13:21:46.566923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_user_events.hub_event, now model.dbt_user_events.hub_user)
[0m13:21:46.567475 [debug] [Thread-1 (]: Began compiling node model.dbt_user_events.hub_user
[0m13:21:46.573170 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_user_events.hub_user"
[0m13:21:46.573976 [debug] [Thread-1 (]: Began executing node model.dbt_user_events.hub_user
[0m13:21:46.577538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:47.026356 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_user_events.hub_user"
[0m13:21:47.029372 [debug] [Thread-1 (]: On model.dbt_user_events.hub_user: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_user_events", "target_name": "dev", "node_id": "model.dbt_user_events.hub_user"} */

  
    

    create or replace table `user-event-pipeline`.`bq_user_events`.`hub_user`
      
    
    

    OPTIONS()
    as (
      

SELECT DISTINCT
  user_id,
  to_hex(md5(cast(coalesce(cast(event_id as string), '_dbt_utils_surrogate_key_null_') as string))) AS hub_user_id,
  CURRENT_TIMESTAMP() AS load_ts
FROM `user-event-pipeline`.`bq_user_events`.`raw_events`
WHERE user_id IS NOT NULL
    );
  
[0m13:21:47.740009 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=user-event-pipeline&j=bq:EU:ebd6ba07-4c66-40ca-aa0e-d25cf8c3cf43&page=queryresults
[0m13:21:49.900919 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a66dc46-557d-4e10-8620-f37a6c0895de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa722cf81c0>]}
[0m13:21:49.904494 [info ] [Thread-1 (]: 2 of 4 OK created sql table model bq_user_events.hub_user ...................... [[32mCREATE TABLE (10.0 rows, 190.0 Bytes processed)[0m in 3.33s]
[0m13:21:49.907677 [debug] [Thread-1 (]: Finished running node model.dbt_user_events.hub_user
[0m13:21:49.910039 [debug] [Thread-1 (]: Began running node model.dbt_user_events.link_user_event
[0m13:21:49.912880 [info ] [Thread-1 (]: 3 of 4 START sql table model bq_user_events.link_user_event .................... [RUN]
[0m13:21:49.915432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_user_events.hub_user, now model.dbt_user_events.link_user_event)
[0m13:21:49.917151 [debug] [Thread-1 (]: Began compiling node model.dbt_user_events.link_user_event
[0m13:21:49.935201 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_user_events.link_user_event"
[0m13:21:49.937034 [debug] [Thread-1 (]: Began executing node model.dbt_user_events.link_user_event
[0m13:21:49.943372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:50.404497 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_user_events.link_user_event"
[0m13:21:50.407609 [debug] [Thread-1 (]: On model.dbt_user_events.link_user_event: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_user_events", "target_name": "dev", "node_id": "model.dbt_user_events.link_user_event"} */

  
    

    create or replace table `user-event-pipeline`.`bq_user_events`.`link_user_event`
      
    
    

    OPTIONS()
    as (
      

SELECT DISTINCT
  to_hex(md5(cast(coalesce(cast(user_id as string), '_dbt_utils_surrogate_key_null_') as string))) AS hub_user_id,
  to_hex(md5(cast(coalesce(cast(event_id as string), '_dbt_utils_surrogate_key_null_') as string))) AS hub_event_id,
  CURRENT_TIMESTAMP() AS load_ts
FROM `user-event-pipeline`.`bq_user_events`.`raw_events`
WHERE user_id IS NOT NULL AND event_id IS NOT NULL
    );
  
[0m13:21:50.832446 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=user-event-pipeline&j=bq:EU:029cb728-9d9f-4dd1-8d8c-31a08caa1d21&page=queryresults
[0m13:21:53.588612 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a66dc46-557d-4e10-8620-f37a6c0895de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6eacef670>]}
[0m13:21:53.591898 [info ] [Thread-1 (]: 3 of 4 OK created sql table model bq_user_events.link_user_event ............... [[32mCREATE TABLE (10.0 rows, 190.0 Bytes processed)[0m in 3.67s]
[0m13:21:53.595100 [debug] [Thread-1 (]: Finished running node model.dbt_user_events.link_user_event
[0m13:21:53.597504 [debug] [Thread-1 (]: Began running node model.dbt_user_events.sat_event_metadata
[0m13:21:53.600343 [info ] [Thread-1 (]: 4 of 4 START sql table model bq_user_events.sat_event_metadata ................. [RUN]
[0m13:21:53.603170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_user_events.link_user_event, now model.dbt_user_events.sat_event_metadata)
[0m13:21:53.605407 [debug] [Thread-1 (]: Began compiling node model.dbt_user_events.sat_event_metadata
[0m13:21:53.619038 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_user_events.sat_event_metadata"
[0m13:21:53.620475 [debug] [Thread-1 (]: Began executing node model.dbt_user_events.sat_event_metadata
[0m13:21:53.708233 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:54.191990 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_user_events.sat_event_metadata"
[0m13:21:54.195031 [debug] [Thread-1 (]: On model.dbt_user_events.sat_event_metadata: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_user_events", "target_name": "dev", "node_id": "model.dbt_user_events.sat_event_metadata"} */

  
    

    create or replace table `user-event-pipeline`.`bq_user_events`.`sat_event_metadata`
      
    
    

    OPTIONS()
    as (
      

SELECT
  to_hex(md5(cast(coalesce(cast(event_id as string), '_dbt_utils_surrogate_key_null_') as string))) AS hub_event_id,
  event_type,
  page,
  device_type,
  TIMESTAMP(timestamp) AS event_timestamp,
  CURRENT_TIMESTAMP() AS load_ts
FROM `user-event-pipeline`.`bq_user_events`.`raw_events`
    );
  
[0m13:21:54.803938 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=user-event-pipeline&j=bq:EU:7de2c8d1-1838-4e60-8d0e-a85ffb47d373&page=queryresults
[0m13:21:56.965666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a66dc46-557d-4e10-8620-f37a6c0895de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6ead39810>]}
[0m13:21:56.969508 [info ] [Thread-1 (]: 4 of 4 OK created sql table model bq_user_events.sat_event_metadata ............ [[32mCREATE TABLE (10.0 rows, 420.0 Bytes processed)[0m in 3.36s]
[0m13:21:56.972676 [debug] [Thread-1 (]: Finished running node model.dbt_user_events.sat_event_metadata
[0m13:21:56.977239 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:21:57.047520 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:57.048140 [debug] [MainThread]: Connection 'model.dbt_user_events.sat_event_metadata' was properly closed.
[0m13:21:57.048729 [info ] [MainThread]: 
[0m13:21:57.049264 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 15.60 seconds (15.60s).
[0m13:21:57.050629 [debug] [MainThread]: Command end result
[0m13:21:57.083791 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kourosh/user_event_pipeline/dbt/target/manifest.json
[0m13:21:57.086102 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kourosh/user_event_pipeline/dbt/target/semantic_manifest.json
[0m13:21:57.093019 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kourosh/user_event_pipeline/dbt/target/run_results.json
[0m13:21:57.093578 [info ] [MainThread]: 
[0m13:21:57.094156 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:21:57.094663 [info ] [MainThread]: 
[0m13:21:57.095234 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:21:57.095995 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.575197, "process_in_blocks": "8", "process_kernel_time": 0.498076, "process_mem_max_rss": "261708", "process_out_blocks": "2648", "process_user_time": 4.936578}
[0m13:21:57.096709 [debug] [MainThread]: Command `dbt run` succeeded at 13:21:57.096585 after 17.58 seconds
[0m13:21:57.097347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7229771c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6ead0bbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6ead0bac0>]}
[0m13:21:57.097958 [debug] [MainThread]: Flushing usage events
[0m13:21:57.791539 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:22:03.449080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7339f7160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb70b143b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb70b141fc0>]}


============================== 13:22:03.453286 | c2a2bde0-bb90-4459-9445-0dc869dc7e00 ==============================
[0m13:22:03.453286 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:22:03.454077 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kourosh/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/kourosh/user_event_pipeline/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:22:04.745072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2a2bde0-bb90-4459-9445-0dc869dc7e00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb73393fb50>]}
[0m13:22:04.811471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2a2bde0-bb90-4459-9445-0dc869dc7e00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb70b60f8e0>]}
[0m13:22:04.812342 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:22:04.980647 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:22:05.135363 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:22:05.135958 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:22:05.143227 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_user_events.example
[0m13:22:05.199601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2a2bde0-bb90-4459-9445-0dc869dc7e00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6fbd74be0>]}
[0m13:22:05.315817 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kourosh/user_event_pipeline/dbt/target/manifest.json
[0m13:22:05.317655 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kourosh/user_event_pipeline/dbt/target/semantic_manifest.json
[0m13:22:05.327895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2a2bde0-bb90-4459-9445-0dc869dc7e00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6fbd77250>]}
[0m13:22:05.328654 [info ] [MainThread]: Found 6 models, 6 data tests, 1 source, 605 macros
[0m13:22:05.329202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2a2bde0-bb90-4459-9445-0dc869dc7e00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6fbd772b0>]}
[0m13:22:05.330711 [info ] [MainThread]: 
[0m13:22:05.331380 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:22:05.331933 [info ] [MainThread]: 
[0m13:22:05.332670 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:22:05.337861 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_user-event-pipeline'
[0m13:22:05.338514 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:22:05.842082 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user-event-pipeline, now list_user-event-pipeline_bq_user_events)
[0m13:22:05.844322 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:22:06.323396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2a2bde0-bb90-4459-9445-0dc869dc7e00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb70b667760>]}
[0m13:22:06.325868 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:22:06.390126 [debug] [Thread-1 (]: Began running node model.dbt_user_events.hub_event
[0m13:22:06.390891 [info ] [Thread-1 (]: 1 of 6 START sql table model bq_user_events.hub_event .......................... [RUN]
[0m13:22:06.391537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user-event-pipeline_bq_user_events, now model.dbt_user_events.hub_event)
[0m13:22:06.392080 [debug] [Thread-1 (]: Began compiling node model.dbt_user_events.hub_event
[0m13:22:06.419073 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_user_events.hub_event"
[0m13:22:06.419989 [debug] [Thread-1 (]: Began executing node model.dbt_user_events.hub_event
[0m13:22:06.436104 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:22:06.946292 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_user_events.hub_event"
[0m13:22:06.947345 [debug] [Thread-1 (]: On model.dbt_user_events.hub_event: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_user_events", "target_name": "dev", "node_id": "model.dbt_user_events.hub_event"} */

  
    

    create or replace table `user-event-pipeline`.`bq_user_events`.`hub_event`
      
    
    

    OPTIONS()
    as (
      

SELECT DISTINCT
  event_id,
  to_hex(md5(cast(coalesce(cast(event_id as string), '_dbt_utils_surrogate_key_null_') as string))) AS hub_event_id,
  CURRENT_TIMESTAMP() AS load_ts
FROM `user-event-pipeline`.`bq_user_events`.`raw_events`
WHERE event_id IS NOT NULL
    );
  
[0m13:22:07.399167 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=user-event-pipeline&j=bq:EU:81e81f62-d03d-4ca6-b78b-367d234f4061&page=queryresults
[0m13:22:09.912017 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2a2bde0-bb90-4459-9445-0dc869dc7e00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6fc34a950>]}
[0m13:22:09.913124 [info ] [Thread-1 (]: 1 of 6 OK created sql table model bq_user_events.hub_event ..................... [[32mCREATE TABLE (10.0 rows, 90.0 Bytes processed)[0m in 3.52s]
[0m13:22:09.913987 [debug] [Thread-1 (]: Finished running node model.dbt_user_events.hub_event
[0m13:22:09.914616 [debug] [Thread-1 (]: Began running node model.dbt_user_events.hub_user
[0m13:22:09.915306 [info ] [Thread-1 (]: 2 of 6 START sql table model bq_user_events.hub_user ........................... [RUN]
[0m13:22:09.916009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_user_events.hub_event, now model.dbt_user_events.hub_user)
[0m13:22:09.916601 [debug] [Thread-1 (]: Began compiling node model.dbt_user_events.hub_user
[0m13:22:09.922283 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_user_events.hub_user"
[0m13:22:09.923104 [debug] [Thread-1 (]: Began executing node model.dbt_user_events.hub_user
[0m13:22:09.927217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:22:10.476955 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_user_events.hub_user"
[0m13:22:10.480173 [debug] [Thread-1 (]: On model.dbt_user_events.hub_user: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_user_events", "target_name": "dev", "node_id": "model.dbt_user_events.hub_user"} */

  
    

    create or replace table `user-event-pipeline`.`bq_user_events`.`hub_user`
      
    
    

    OPTIONS()
    as (
      

SELECT DISTINCT
  user_id,
  to_hex(md5(cast(coalesce(cast(event_id as string), '_dbt_utils_surrogate_key_null_') as string))) AS hub_user_id,
  CURRENT_TIMESTAMP() AS load_ts
FROM `user-event-pipeline`.`bq_user_events`.`raw_events`
WHERE user_id IS NOT NULL
    );
  
[0m13:22:11.079666 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=user-event-pipeline&j=bq:EU:31d9cbb1-8fb2-4cb5-b87f-ef2d966faed2&page=queryresults
[0m13:22:13.558073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2a2bde0-bb90-4459-9445-0dc869dc7e00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6fbd59ff0>]}
[0m13:22:13.560026 [info ] [Thread-1 (]: 2 of 6 OK created sql table model bq_user_events.hub_user ...................... [[32mCREATE TABLE (10.0 rows, 190.0 Bytes processed)[0m in 3.64s]
[0m13:22:13.561947 [debug] [Thread-1 (]: Finished running node model.dbt_user_events.hub_user
[0m13:22:13.562953 [debug] [Thread-1 (]: Began running node model.dbt_user_events.link_user_event
[0m13:22:13.564182 [info ] [Thread-1 (]: 3 of 6 START sql table model bq_user_events.link_user_event .................... [RUN]
[0m13:22:13.565423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_user_events.hub_user, now model.dbt_user_events.link_user_event)
[0m13:22:13.567135 [debug] [Thread-1 (]: Began compiling node model.dbt_user_events.link_user_event
[0m13:22:13.579353 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_user_events.link_user_event"
[0m13:22:13.580256 [debug] [Thread-1 (]: Began executing node model.dbt_user_events.link_user_event
[0m13:22:13.584477 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:22:14.058895 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_user_events.link_user_event"
[0m13:22:14.062534 [debug] [Thread-1 (]: On model.dbt_user_events.link_user_event: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_user_events", "target_name": "dev", "node_id": "model.dbt_user_events.link_user_event"} */

  
    

    create or replace table `user-event-pipeline`.`bq_user_events`.`link_user_event`
      
    
    

    OPTIONS()
    as (
      

SELECT DISTINCT
  to_hex(md5(cast(coalesce(cast(user_id as string), '_dbt_utils_surrogate_key_null_') as string))) AS hub_user_id,
  to_hex(md5(cast(coalesce(cast(event_id as string), '_dbt_utils_surrogate_key_null_') as string))) AS hub_event_id,
  CURRENT_TIMESTAMP() AS load_ts
FROM `user-event-pipeline`.`bq_user_events`.`raw_events`
WHERE user_id IS NOT NULL AND event_id IS NOT NULL
    );
  
[0m13:22:14.421302 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=user-event-pipeline&j=bq:EU:87e297c0-ce7a-41c6-9537-dd7642ff6942&page=queryresults
[0m13:22:16.940420 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2a2bde0-bb90-4459-9445-0dc869dc7e00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6f9a9e290>]}
[0m13:22:16.944307 [info ] [Thread-1 (]: 3 of 6 OK created sql table model bq_user_events.link_user_event ............... [[32mCREATE TABLE (10.0 rows, 190.0 Bytes processed)[0m in 3.37s]
[0m13:22:16.947562 [debug] [Thread-1 (]: Finished running node model.dbt_user_events.link_user_event
[0m13:22:16.949887 [debug] [Thread-1 (]: Began running node model.dbt_user_events.sat_event_metadata
[0m13:22:16.952803 [info ] [Thread-1 (]: 4 of 6 START sql table model bq_user_events.sat_event_metadata ................. [RUN]
[0m13:22:16.955249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_user_events.link_user_event, now model.dbt_user_events.sat_event_metadata)
[0m13:22:16.956800 [debug] [Thread-1 (]: Began compiling node model.dbt_user_events.sat_event_metadata
[0m13:22:16.970505 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_user_events.sat_event_metadata"
[0m13:22:16.971552 [debug] [Thread-1 (]: Began executing node model.dbt_user_events.sat_event_metadata
[0m13:22:17.060268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:22:17.539543 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_user_events.sat_event_metadata"
[0m13:22:17.542653 [debug] [Thread-1 (]: On model.dbt_user_events.sat_event_metadata: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_user_events", "target_name": "dev", "node_id": "model.dbt_user_events.sat_event_metadata"} */

  
    

    create or replace table `user-event-pipeline`.`bq_user_events`.`sat_event_metadata`
      
    
    

    OPTIONS()
    as (
      

SELECT
  to_hex(md5(cast(coalesce(cast(event_id as string), '_dbt_utils_surrogate_key_null_') as string))) AS hub_event_id,
  event_type,
  page,
  device_type,
  TIMESTAMP(timestamp) AS event_timestamp,
  CURRENT_TIMESTAMP() AS load_ts
FROM `user-event-pipeline`.`bq_user_events`.`raw_events`
    );
  
[0m13:22:18.152516 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=user-event-pipeline&j=bq:EU:270f8e88-3dac-4598-8f88-699596751443&page=queryresults
[0m13:22:20.583313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2a2bde0-bb90-4459-9445-0dc869dc7e00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6fbda5900>]}
[0m13:22:20.586816 [info ] [Thread-1 (]: 4 of 6 OK created sql table model bq_user_events.sat_event_metadata ............ [[32mCREATE TABLE (10.0 rows, 420.0 Bytes processed)[0m in 3.63s]
[0m13:22:20.590116 [debug] [Thread-1 (]: Finished running node model.dbt_user_events.sat_event_metadata
[0m13:22:20.593063 [debug] [Thread-1 (]: Began running node model.dbt_user_events.stg_raw_events
[0m13:22:20.596168 [info ] [Thread-1 (]: 5 of 6 START sql view model bq_user_events.stg_raw_events ...................... [RUN]
[0m13:22:20.598968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_user_events.sat_event_metadata, now model.dbt_user_events.stg_raw_events)
[0m13:22:20.600883 [debug] [Thread-1 (]: Began compiling node model.dbt_user_events.stg_raw_events
[0m13:22:20.612547 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_user_events.stg_raw_events"
[0m13:22:20.613923 [debug] [Thread-1 (]: Began executing node model.dbt_user_events.stg_raw_events
[0m13:22:20.638463 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_user_events.stg_raw_events"
[0m13:22:20.639372 [debug] [Thread-1 (]: On model.dbt_user_events.stg_raw_events: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_user_events", "target_name": "dev", "node_id": "model.dbt_user_events.stg_raw_events"} */


  create or replace view `user-event-pipeline`.`bq_user_events`.`stg_raw_events`
  OPTIONS()
  as 

SELECT
  event_id,
  user_id,
  event_type,
  page,
  TIMESTAMP(timestamp) AS event_timestamp,
  device_type
FROM `user-event-pipeline`.`bq_user_events`.`raw_events`;


[0m13:22:20.640001 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:22:21.282285 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=user-event-pipeline&j=bq:EU:009fa369-ffdb-41c8-b12d-2aa9a41187fa&page=queryresults
[0m13:22:21.515223 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2a2bde0-bb90-4459-9445-0dc869dc7e00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6fbd87100>]}
[0m13:22:21.518626 [info ] [Thread-1 (]: 5 of 6 OK created sql view model bq_user_events.stg_raw_events ................. [[32mCREATE VIEW (0 processed)[0m in 0.91s]
[0m13:22:21.521798 [debug] [Thread-1 (]: Finished running node model.dbt_user_events.stg_raw_events
[0m13:22:21.525379 [debug] [Thread-1 (]: Began running node model.dbt_user_events.daily_events
[0m13:22:21.528066 [info ] [Thread-1 (]: 6 of 6 START sql table model bq_user_events.daily_events ....................... [RUN]
[0m13:22:21.530078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_user_events.stg_raw_events, now model.dbt_user_events.daily_events)
[0m13:22:21.531695 [debug] [Thread-1 (]: Began compiling node model.dbt_user_events.daily_events
[0m13:22:21.539580 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_user_events.daily_events"
[0m13:22:21.540875 [debug] [Thread-1 (]: Began executing node model.dbt_user_events.daily_events
[0m13:22:21.547204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:22:22.149517 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_user_events.daily_events"
[0m13:22:22.152494 [debug] [Thread-1 (]: On model.dbt_user_events.daily_events: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_user_events", "target_name": "dev", "node_id": "model.dbt_user_events.daily_events"} */

  
    

    create or replace table `user-event-pipeline`.`bq_user_events`.`daily_events`
      
    
    

    OPTIONS()
    as (
      

SELECT
  DATE(event_timestamp) AS event_date,
  user_id,
  device_type,
  COUNT(*) AS event_count
FROM `user-event-pipeline`.`bq_user_events`.`stg_raw_events`
GROUP BY 1, 2, 3
    );
  
[0m13:22:23.067508 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=user-event-pipeline&j=bq:EU:fdd36d8d-1382-4e13-a7dc-79f98a8cf6fa&page=queryresults
[0m13:22:25.417174 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2a2bde0-bb90-4459-9445-0dc869dc7e00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6f9aa4700>]}
[0m13:22:25.420494 [info ] [Thread-1 (]: 6 of 6 OK created sql table model bq_user_events.daily_events .................. [[32mCREATE TABLE (8.0 rows, 263.0 Bytes processed)[0m in 3.89s]
[0m13:22:25.424256 [debug] [Thread-1 (]: Finished running node model.dbt_user_events.daily_events
[0m13:22:25.428781 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:22:25.478716 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:22:25.479348 [debug] [MainThread]: Connection 'model.dbt_user_events.daily_events' was properly closed.
[0m13:22:25.479925 [info ] [MainThread]: 
[0m13:22:25.480457 [info ] [MainThread]: Finished running 5 table models, 1 view model in 0 hours 0 minutes and 20.15 seconds (20.15s).
[0m13:22:25.482186 [debug] [MainThread]: Command end result
[0m13:22:25.515160 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kourosh/user_event_pipeline/dbt/target/manifest.json
[0m13:22:25.517232 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kourosh/user_event_pipeline/dbt/target/semantic_manifest.json
[0m13:22:25.526460 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kourosh/user_event_pipeline/dbt/target/run_results.json
[0m13:22:25.527487 [info ] [MainThread]: 
[0m13:22:25.528638 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:22:25.529942 [info ] [MainThread]: 
[0m13:22:25.531019 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m13:22:25.532110 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 22.14969, "process_in_blocks": "0", "process_kernel_time": 0.557808, "process_mem_max_rss": "261692", "process_out_blocks": "2712", "process_user_time": 5.259338}
[0m13:22:25.533142 [debug] [MainThread]: Command `dbt run` succeeded at 13:22:25.533021 after 22.15 seconds
[0m13:22:25.533702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7339f7160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb73393fb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6fc38ff40>]}
[0m13:22:25.534275 [debug] [MainThread]: Flushing usage events
[0m13:22:26.446538 [debug] [MainThread]: An error was encountered while trying to flush usage events
